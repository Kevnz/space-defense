(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var globals = {
  bullets: null,
  enemies: null,
  player: null
};
var update = require('./game/update');
var preload = require('./game/preload');
var create = require('./game/create');
var game = window.game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
  preload: preload,
  create: create,
  update: update
});


},{"./game/create":2,"./game/preload":4,"./game/update":6}],2:[function(require,module,exports){
"use strict";
function resetBullet(bullet) {
  bullet.kill();
}
;
function setupEnemy(enemy) {
  enemy.anchor.x = 0.5;
  enemy.anchor.y = 0.5;
  enemy.animations.add('explode');
}
;
module.exports = function() {
  game.physics.startSystem(Phaser.Physics.ARCADE);
  this.spaceBG = this.add.tileSprite(0, 0, 800, 600, 'bg');
  this.spaceBG.autoScroll(0, 75);
  window.player = require('./player')(game);
  player.init();
  var bullets = window.bullets = this.add.group();
  bullets.enableBody = true;
  bullets.physicsBodyType = Phaser.Physics.ARCADE;
  bullets.createMultiple(10, 'bullets', 'bullet-green.png');
  bullets.setAll('anchor.x', 0.5);
  bullets.setAll('anchor.y', 1);
  bullets.setAll('outOfBoundsKill', true);
  bullets.setAll('checkWorldBounds', true);
  window.explosions = game.add.group();
  explosions.createMultiple(30, 'explode');
  explosions.forEach(setupEnemy, this);
  window.music = game.add.audio('stage-1');
  window.boom = game.add.audio('boom');
  window.lazer = game.add.audio('lazer');
  window.stage1 = require('./scenes/scene-1')(game);
  stage1.init();
};


},{"./player":3,"./scenes/scene-1":5}],3:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var player,
      cursors;
  var right_bulletTime = 0,
      left_bulletTime = 0;
  var playerSpeed = 200;
  function fireBullet() {
    if (game.time.now > right_bulletTime) {
      var right_bullet = bullets.getFirstExists(false);
      if (right_bullet) {
        right_bullet.reset(player.x, player.y + 16);
        right_bullet.body.velocity.y = -300;
        right_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
    if (game.time.now > left_bulletTime + 20) {
      var left_bullet = bullets.getFirstExists(false);
      if (left_bullet) {
        left_bullet.reset(player.x + 26, player.y + 16);
        left_bullet.body.velocity.y = -300;
        left_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
  }
  return {
    init: function() {
      player = game.add.sprite((400 - 16), 500, 'ship');
      game.physics.enable(player, Phaser.Physics.ARCADE);
      cursors = game.input.keyboard.createCursorKeys();
    },
    update: function() {
      if (cursors.up.isDown) {
        if (cursors.up.shiftKey) {} else {
          if (player.y > 350)
            player.y -= 4;
        }
      } else if (cursors.down.isDown) {
        if (cursors.down.shiftKey) {} else {
          player.y += 4;
        }
      }
      if (cursors.left.isDown) {
        player.x -= 4;
      } else if (cursors.right.isDown) {
        player.x += 4;
      }
      if (game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {
        fireBullet();
      }
      if (game.input.joystickLeft) {
        player.body.velocity.setTo(game.input.joystickLeft.normalizedX * 200, game.input.joystickLeft.normalizedY * playerSpeed * -1);
      } else {
        player.body.velocity.setTo(0, 0);
      }
    }
  };
};


},{}],4:[function(require,module,exports){
"use strict";
module.exports = function() {
  this.load.atlas('bullets', 'img/assets/bullets.png', 'img/assets/bullets.json');
  this.load.image('blue_bullet', 'img/assets/blue-bullet.png');
  this.load.image('bg', 'img/backgrounds/bg.png');
  this.load.atlas('atlas', 'img/enemy-fighters/enemy-fighters.png', 'img/enemy-fighters/enemy-fighters.json');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.spritesheet('explode', 'img/assets/explode.png', 128, 128);
  this.load.audio('boom', ['audio/effects/explode.wav']);
  this.load.audio('lazer', ['audio/effects/lazer.wav']);
  this.load.audio('stage-1', ['audio/background/stage-1.mp3', 'audio/background/stage-1.ogg']);
};


},{}],5:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var raptors;
  var spawn = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = aliens.create(x, y, 'atlas', 'bad-guy1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 100);
  };
  var collisionHandler = function(bullet, alien) {
    bullet.kill();
    alien.kill();
    window.boom.play();
    var x = alien.body.x,
        y = alien.body.y;
    var explosion = explosions.getFirstExists(false);
    explosion.reset(alien.body.x, alien.body.y);
    explosion.play('explode', 30, false, true);
  };
  var spawnRaptor = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = raptors.create(x, y, 'atlas', 'raptor-1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 150);
  };
  var enemyFactory;
  return {
    init: function() {
      window.aliens = game.add.group();
      aliens.enableBody = true;
      aliens.physicsBodyType = Phaser.Physics.ARCADE;
      raptors = game.add.group();
      raptors.enableBody = true;
      raptors.physicsBodyType = Phaser.Physics.ARCADE;
      music.play('', 0, 1, true);
      game.time.events.repeat(Phaser.Timer.SECOND * 2, 105, spawn, this);
      game.time.events.repeat(Phaser.Timer.SECOND * 8, 20, spawnRaptor, this);
    },
    update: function() {
      game.physics.arcade.overlap(bullets, aliens, collisionHandler, null, this);
      game.physics.arcade.overlap(bullets, raptors, collisionHandler, null, this);
    },
    destroy: function() {}
  };
};


},{}],6:[function(require,module,exports){
"use strict";
var bulletTime = 0;
function resetBullet(bullet) {
  bullet.kill();
}
;
var right_bulletTime = 0,
    left_bulletTime = 0;
module.exports = function() {
  var bullets = window.bullets;
  var cursors = window.cursors;
  player.update();
  stage1.update();
};


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZS5qcyIsIkM6XFxVc2Vyc1xcS2V2aW5cXFByb2plY3RzXFxzcGFjZS1kZWZlbnNlXFxwdWJsaWNcXGpzXFxnYW1lXFxjcmVhdGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZVxccGxheWVyLmpzIiwiQzpcXFVzZXJzXFxLZXZpblxcUHJvamVjdHNcXHNwYWNlLWRlZmVuc2VcXHB1YmxpY1xcanNcXGdhbWVcXHByZWxvYWQuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZVxcc2NlbmVzXFxzY2VuZS0xLmpzIiwiQzpcXFVzZXJzXFxLZXZpblxcUHJvamVjdHNcXHNwYWNlLWRlZmVuc2VcXHB1YmxpY1xcanNcXGdhbWVcXHVwZGF0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQUksQ0FBSixFQUFJLENBQUEsT0FBTyxFQUFHO0FBQ1YsQ0FBQSxRQUFPLENBQUUsS0FBSTtBQUNiLENBQUEsUUFBTyxDQUFFLEtBQUk7QUFDYixDQUFBLE9BQU0sQ0FBRSxLQUFJO0NBQUEsQUFDZixDQUFBO0FBQ0csQ0FBSixFQUFJLENBQUEsTUFBTSxFQUFHLENBQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ2xDLENBQUosRUFBSSxDQUFBLE9BQU8sRUFBRyxDQUFBLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFFO0FBQ3JDLENBQUosRUFBSSxDQUFBLE1BQU0sRUFBRyxDQUFBLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUVsQyxDQUFKLEVBQUksQ0FBQSxJQUFJLEVBQUcsQ0FBQSxNQUFNLEtBQUssRUFBRyxJQUFJLENBQUEsTUFBTSxLQUFLLENBQUMsR0FBRyxDQUFFLElBQUcsQ0FBRSxDQUFBLE1BQU0sS0FBSyxDQUFFLEdBQUUsQ0FBRTtBQUFFLENBQUEsUUFBTyxDQUFFLFFBQU87QUFBRSxDQUFBLE9BQU0sQ0FBRSxPQUFNO0FBQUUsQ0FBQSxPQUFNLENBQUUsT0FBTTtDQUFBLEFBQUUsQ0FBQyxDQUFDO0NBQzFIOzs7QUNWQztDQUFBLE9BQVMsWUFBVyxDQUFFLE1BQU0sQ0FBRTtBQUUzQixDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7Q0FFakI7QUFDRCxDQURDLEFBQ0E7Q0FDRCxPQUFTLFdBQVUsQ0FBRSxLQUFLLENBQUU7QUFFeEIsQ0FBQSxNQUFLLE9BQU8sRUFBRSxFQUFHLElBQUcsQ0FBQztBQUNyQixDQUFBLE1BQUssT0FBTyxFQUFFLEVBQUcsSUFBRyxDQUFDO0FBQ3JCLENBQUEsTUFBSyxXQUFXLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztDQUVuQztBQUFBLENBQUEsQUFBQztBQUVGLENBQUEsS0FBTSxRQUFRLEVBQU0sVUFBUyxDQUFDO0FBRTFCLENBQUEsS0FBSSxRQUFRLFlBQVksQ0FBQyxNQUFNLFFBQVEsT0FBTyxDQUFDLENBQUM7QUFFaEQsQ0FBQSxLQUFJLFFBQVEsRUFBSSxDQUFBLElBQUksSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFFLEVBQUMsQ0FBRSxJQUFHLENBQUUsSUFBRyxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBQzFELENBQUEsS0FBSSxRQUFRLFdBQVcsQ0FBQyxDQUFDLENBQUUsR0FBRSxDQUFDLENBQUM7QUFHL0IsQ0FBQSxPQUFNLE9BQU8sRUFBRyxDQUFBLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMxQyxDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7QUFDVixDQUFKLElBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxNQUFNLFFBQVEsRUFBRyxDQUFBLElBQUksSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUVoRCxDQUFBLFFBQU8sV0FBVyxFQUFHLEtBQUksQ0FBQztBQUUxQixDQUFBLFFBQU8sZ0JBQWdCLEVBQUcsQ0FBQSxNQUFNLFFBQVEsT0FBTyxDQUFDO0FBRWhELENBQUEsUUFBTyxlQUFlLENBQUMsRUFBRSxDQUFFLFVBQVMsQ0FBRSxtQkFBa0IsQ0FBQyxDQUFDO0FBQzFELENBQUEsUUFBTyxPQUFPLENBQUMsVUFBVSxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBQ2hDLENBQUEsUUFBTyxPQUFPLENBQUMsVUFBVSxDQUFFLEVBQUMsQ0FBQyxDQUFDO0FBQzlCLENBQUEsUUFBTyxPQUFPLENBQUMsaUJBQWlCLENBQUUsS0FBSSxDQUFDLENBQUM7QUFDeEMsQ0FBQSxRQUFPLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBRSxLQUFJLENBQUMsQ0FBQztBQUt6QyxDQUFBLE9BQU0sV0FBVyxFQUFHLENBQUEsSUFBSSxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQ3JDLENBQUEsV0FBVSxlQUFlLENBQUMsRUFBRSxDQUFFLFVBQVMsQ0FBQyxDQUFDO0FBQ3pDLENBQUEsV0FBVSxRQUFRLENBQUMsVUFBVSxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBQ3JDLENBQUEsT0FBTSxNQUFNLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3pDLENBQUEsT0FBTSxLQUFLLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3JDLENBQUEsT0FBTSxNQUFNLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBR3ZDLENBQUEsT0FBTSxPQUFPLEVBQUcsQ0FBQSxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsRCxDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7Q0FDakIsQ0FBQTtDQUVBOzs7QUNuREQ7QUFBQSxDQUFBLEtBQU0sUUFBUSxFQUFHLFVBQVUsSUFBSSxDQUFFO0FBQzVCLENBQUosSUFBSSxDQUFBLE1BQU07QUFBRSxDQUFBLFlBQU8sQ0FBQztBQUNoQixDQUFKLElBQUksQ0FBQSxnQkFBZ0IsRUFBRyxFQUFDO0FBQUUsQ0FBQSxvQkFBZSxFQUFHLEVBQUMsQ0FBQztBQUN2QyxDQUFKLElBQUksQ0FBQSxXQUFXLEVBQUcsSUFBRyxDQUFDO0NBRWxCLFNBQVMsV0FBVSxDQUFFLENBQUU7Q0FDbkIsT0FBSyxJQUFJLEtBQUssSUFBSSxFQUFHLGlCQUFnQixDQUNyQztBQUNRLENBQUosUUFBSSxDQUFBLFlBQVksRUFBRyxDQUFBLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO0NBQ2pELFNBQUksWUFBWSxDQUNoQjtBQUVJLENBQUEsbUJBQVksTUFBTSxDQUFDLE1BQU0sRUFBRSxDQUFFLENBQUEsTUFBTSxFQUFFLEVBQUcsR0FBRSxDQUFDLENBQUM7QUFDNUMsQ0FBQSxtQkFBWSxLQUFLLFNBQVMsRUFBRSxFQUFHLEVBQUMsR0FBRyxDQUFDO0FBQ3BDLENBQUEsdUJBQWdCLEVBQUcsQ0FBQSxJQUFJLEtBQUssSUFBSSxFQUFHLEtBQUksQ0FBQztBQUN4QyxDQUFBLFlBQUssS0FBSyxFQUFFLENBQUM7T0FDaEI7Q0FBQSxJQUNKO0FBQ0QsQ0FEQyxPQUNJLElBQUksS0FBSyxJQUFJLEVBQUcsQ0FBQSxlQUFlLEVBQUcsR0FBRSxDQUN6QztBQUNRLENBQUosUUFBSSxDQUFBLFdBQVcsRUFBRyxDQUFBLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO0NBQ2hELFNBQUksV0FBVyxDQUNmO0FBRUksQ0FBQSxrQkFBVyxNQUFNLENBQUMsTUFBTSxFQUFFLEVBQUcsR0FBRSxDQUFFLENBQUEsTUFBTSxFQUFFLEVBQUcsR0FBRSxDQUFDLENBQUM7QUFDaEQsQ0FBQSxrQkFBVyxLQUFLLFNBQVMsRUFBRSxFQUFHLEVBQUMsR0FBRyxDQUFDO0FBQ25DLENBQUEsc0JBQWUsRUFBRyxDQUFBLElBQUksS0FBSyxJQUFJLEVBQUcsS0FBSSxDQUFDO0FBQ3ZDLENBQUEsWUFBSyxLQUFLLEVBQUUsQ0FBQztPQUNoQjtDQUFBLElBQ0o7Q0FBQSxFQUNKO0FBRVIsQ0FGUSxPQUVEO0FBQ04sQ0FBQSxPQUFJLENBQUcsVUFBVSxDQUFFO0FBQ2xCLENBQUEsV0FBTSxFQUFHLENBQUEsSUFBSSxJQUFJLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBRyxHQUFFLENBQUMsQ0FBRSxJQUFHLENBQUUsT0FBTSxDQUFDLENBQUM7QUFDL0MsQ0FBQSxTQUFJLFFBQVEsT0FBTyxDQUFDLE1BQU0sQ0FBRSxDQUFBLE1BQU0sUUFBUSxPQUFPLENBQUMsQ0FBQztBQUNuRCxDQUFBLFlBQU8sRUFBSSxDQUFBLElBQUksTUFBTSxTQUFTLGlCQUFpQixFQUFFLENBQUM7S0FDckQ7QUFDRCxDQUFBLFNBQU0sQ0FBRSxVQUFVLENBQUU7Q0FFYixTQUFJLE9BQU8sR0FBRyxPQUFPLENBQ3JCO0NBRUksV0FBSSxPQUFPLEdBQUcsU0FBUyxDQUN2QixHQUVDLEtBRUQ7Q0FDSSxhQUFHLE1BQU0sRUFBRSxFQUFHLElBQUc7QUFBRSxDQUFBLGlCQUFNLEVBQUUsR0FBSSxFQUFDLENBQUM7Q0FBQSxRQUNwQztDQUFBLE1BQ0osS0FDSSxLQUFJLE9BQU8sS0FBSyxPQUFPLENBQzVCO0NBQ0ksV0FBSSxPQUFPLEtBQUssU0FBUyxDQUN6QixHQUVDLEtBRUQ7QUFDSSxDQUFBLGVBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztTQUNqQjtDQUFBLE1BQ0o7QUFDRCxDQURDLFNBQ0csT0FBTyxLQUFLLE9BQU8sQ0FDdkI7QUFDSSxDQUFBLGFBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztPQUNqQixLQUNJLEtBQUksT0FBTyxNQUFNLE9BQU8sQ0FDN0I7QUFDRyxDQUFBLGFBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztPQUNoQjtBQUNELENBREMsU0FDRyxJQUFJLE1BQU0sU0FBUyxPQUFPLENBQUMsTUFBTSxTQUFTLFNBQVMsQ0FBQyxDQUN4RDtBQUNJLENBQUEsaUJBQVUsRUFBRSxDQUFFO09BQ2pCO0FBSUUsQ0FKRixTQUlNLElBQUksTUFBTSxhQUFhLENBQUU7QUFHekIsQ0FBQSxhQUFNLEtBQUssU0FBUyxNQUFNLENBQUMsSUFBSSxNQUFNLGFBQWEsWUFBWSxFQUFHLElBQUcsQ0FBRSxDQUFBLElBQUksTUFBTSxhQUFhLFlBQVksRUFBRyxZQUFXLENBQUEsQ0FBRyxFQUFDLENBQUMsQ0FBQyxDQUFDO09BQ2pJLEtBQ0k7QUFDRCxDQUFBLGFBQU0sS0FBSyxTQUFTLE1BQU0sQ0FBQyxDQUFDLENBQUUsRUFBQyxDQUFDLENBQUM7T0FDcEM7Q0FBQSxJQUNWO0NBQUEsRUFDRCxDQUFBO0NBQ0QsQ0FBQTtDQUFBOzs7QUN4RkQ7QUFBQSxDQUFBLEtBQU0sUUFBUSxFQUFJLFVBQVUsQ0FBRTtBQUUxQixDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsU0FBUyxDQUFFLHlCQUF3QixDQUFFLDBCQUF5QixDQUFDLENBQUM7QUFDaEYsQ0FBQSxLQUFJLEtBQUssTUFBTSxDQUFDLGFBQWEsQ0FBRSw2QkFBNEIsQ0FBQyxDQUFDO0FBQzdELENBQUEsS0FBSSxLQUFLLE1BQU0sQ0FBQyxJQUFJLENBQUUseUJBQXdCLENBQUMsQ0FBQztBQUNoRCxDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsT0FBTyxDQUFFLHdDQUF1QyxDQUFFLHlDQUF3QyxDQUFDLENBQUM7QUFDNUcsQ0FBQSxLQUFJLEtBQUssTUFBTSxDQUFDLE1BQU0sQ0FBRSwwQkFBeUIsQ0FBQyxDQUFDO0FBQ25ELENBQUEsS0FBSSxLQUFLLFlBQVksQ0FBQyxTQUFTLENBQUUseUJBQXdCLENBQUUsSUFBRyxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBQ3JFLENBQUEsS0FBSSxLQUFLLE1BQU0sQ0FBQyxNQUFNLENBQUUsRUFBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUM7QUFDdkQsQ0FBQSxLQUFJLEtBQUssTUFBTSxDQUFDLE9BQU8sQ0FBRSxFQUFDLHlCQUF5QixDQUFDLENBQUMsQ0FBQztBQUN0RCxDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsU0FBUyxDQUFFLEVBQUMsOEJBQThCLENBQUUsK0JBQThCLENBQUMsQ0FBQyxDQUFDO0NBRWhHLENBQUE7Q0FBQTs7O0FDWkQ7QUFBQSxDQUFBLEtBQU0sUUFBUSxFQUFJLFVBQVUsSUFBSSxDQUFFO0FBQzdCLENBQUosSUFBSSxDQUFBLE9BQU8sQ0FBQztBQUNMLENBQUosSUFBSSxDQUFBLEtBQUssRUFBRyxVQUFVLENBQUU7QUFFaEIsQ0FBSixNQUFJLENBQUEsQ0FBQyxFQUFHLENBQUEsSUFBSSxJQUFJLGVBQWUsQ0FBQyxFQUFFLENBQUUsSUFBRyxDQUFDO0FBQUksQ0FBQSxRQUFDLEVBQUcsQ0FBQSxJQUFJLElBQUksZUFBZSxDQUFDLENBQUMsQ0FBRSxHQUFFLENBQUMsQ0FBQztBQUMzRSxDQUFKLE1BQUksQ0FBQSxNQUFNLEVBQUcsQ0FBQSxNQUFNLE9BQU8sQ0FBQyxDQUFDLENBQUUsRUFBQyxDQUFFLFFBQU8sQ0FBRSxlQUFjLENBQUMsQ0FBQztBQUMxRCxDQUFBLFNBQU0sT0FBTyxNQUFNLENBQUMsR0FBRyxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBRTlCLENBQUEsU0FBTSxLQUFLLE1BQU0sRUFBRyxLQUFJLENBQUM7QUFDekIsQ0FBQSxTQUFNLEtBQUssU0FBUyxNQUFNLENBQUMsQ0FBQyxDQUFFLElBQUcsQ0FBQyxDQUFFO0dBQ3ZDLENBQUM7QUFFRCxDQUFKLElBQUksQ0FBQSxnQkFBZ0IsRUFBRyxVQUFXLE1BQU0sQ0FBRSxDQUFBLEtBQUssQ0FBRTtBQUU3QyxDQUFBLFNBQU0sS0FBSyxFQUFFLENBQUM7QUFDZCxDQUFBLFFBQUssS0FBSyxFQUFFLENBQUM7QUFDYixDQUFBLFNBQU0sS0FBSyxLQUFLLEVBQUUsQ0FBQztBQUNmLENBQUosTUFBSSxDQUFBLENBQUMsRUFBRyxDQUFBLEtBQUssS0FBSyxFQUFFO0FBQUUsQ0FBQSxRQUFDLEVBQUUsQ0FBQSxLQUFLLEtBQUssRUFBRSxDQUFBO0FBQ2pDLENBQUosTUFBSSxDQUFBLFNBQVMsRUFBRyxDQUFBLFVBQVUsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2pELENBQUEsWUFBUyxNQUFNLENBQUMsS0FBSyxLQUFLLEVBQUUsQ0FBRSxDQUFBLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztBQUM1QyxDQUFBLFlBQVMsS0FBSyxDQUFDLFNBQVMsQ0FBRSxHQUFFLENBQUUsTUFBSyxDQUFFLEtBQUksQ0FBQyxDQUFDO0dBQzlDLENBQUM7QUFFSyxDQUFKLElBQUksQ0FBQSxXQUFXLEVBQUcsVUFBVSxDQUFFO0FBQ3pCLENBQUosTUFBSSxDQUFBLENBQUMsRUFBRyxDQUFBLElBQUksSUFBSSxlQUFlLENBQUMsRUFBRSxDQUFFLElBQUcsQ0FBQztBQUFJLENBQUEsUUFBQyxFQUFHLENBQUEsSUFBSSxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUUsR0FBRSxDQUFDLENBQUM7QUFDeEUsQ0FBSixNQUFJLENBQUEsTUFBTSxFQUFHLENBQUEsT0FBTyxPQUFPLENBQUMsQ0FBQyxDQUFFLEVBQUMsQ0FBRSxRQUFPLENBQUUsZUFBYyxDQUFDLENBQUM7QUFDM0QsQ0FBQSxTQUFNLE9BQU8sTUFBTSxDQUFDLEdBQUcsQ0FBRSxJQUFHLENBQUMsQ0FBQztBQUU5QixDQUFBLFNBQU0sS0FBSyxNQUFNLEVBQUcsS0FBSSxDQUFDO0FBQ3pCLENBQUEsU0FBTSxLQUFLLFNBQVMsTUFBTSxDQUFDLENBQUMsQ0FBRSxJQUFHLENBQUMsQ0FBRTtHQUN2QyxDQUFBO0FBQ0EsQ0FBSixJQUFJLENBQUEsWUFBWSxDQUFDO0NBRWpCLE9BQU87QUFDTixDQUFBLE9BQUksQ0FBRSxVQUFVLENBQUU7QUFDakIsQ0FBQSxXQUFNLE9BQU8sRUFBRyxDQUFBLElBQUksSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUM5QixDQUFBLFdBQU0sV0FBVyxFQUFHLEtBQUksQ0FBQztBQUN6QixDQUFBLFdBQU0sZ0JBQWdCLEVBQUcsQ0FBQSxNQUFNLFFBQVEsT0FBTyxDQUFDO0FBQy9DLENBQUEsWUFBTyxFQUFHLENBQUEsSUFBSSxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzNCLENBQUEsWUFBTyxXQUFXLEVBQUcsS0FBSSxDQUFDO0FBQzFCLENBQUEsWUFBTyxnQkFBZ0IsRUFBRyxDQUFBLE1BQU0sUUFBUSxPQUFPLENBQUM7QUFDaEQsQ0FBQSxVQUFLLEtBQUssQ0FBQyxFQUFFLENBQUUsRUFBQyxDQUFFLEVBQUMsQ0FBRSxLQUFJLENBQUMsQ0FBQztBQUUzQixDQUFBLFNBQUksS0FBSyxPQUFPLE9BQU8sQ0FBQyxNQUFNLE1BQU0sT0FBTyxFQUFHLEVBQUMsQ0FBRSxJQUFHLENBQUUsTUFBSyxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBRW5FLENBQUEsU0FBSSxLQUFLLE9BQU8sT0FBTyxDQUFDLE1BQU0sTUFBTSxPQUFPLEVBQUcsRUFBQyxDQUFFLEdBQUUsQ0FBRSxZQUFXLENBQUUsS0FBSSxDQUFDLENBQUM7S0FDM0U7QUFDRCxDQUFBLFNBQU0sQ0FBRyxVQUFVLENBQUU7QUFFcEIsQ0FBQSxTQUFJLFFBQVEsT0FBTyxRQUFRLENBQUMsT0FBTyxDQUFFLE9BQU0sQ0FBRSxpQkFBZ0IsQ0FBRSxLQUFJLENBQUUsS0FBSSxDQUFDLENBQUM7QUFDM0UsQ0FBQSxTQUFJLFFBQVEsT0FBTyxRQUFRLENBQUMsT0FBTyxDQUFFLFFBQU8sQ0FBRSxpQkFBZ0IsQ0FBRSxLQUFJLENBQUUsS0FBSSxDQUFDLENBQUM7S0FDNUU7QUFDRCxDQUFBLFVBQU8sQ0FBRSxVQUFVLENBQUUsR0FFcEI7Q0FBQSxFQUNELENBQUE7Q0FDRCxDQUFBO0NBQUE7OztBQ3hERDtBQUFJLENBQUosRUFBSSxDQUFBLFVBQVUsRUFBRyxFQUFDLENBQUM7Q0FDbEIsT0FBUyxZQUFXLENBQUUsTUFBTSxDQUFFO0FBRTNCLENBQUEsT0FBTSxLQUFLLEVBQUUsQ0FBQztDQUVqQjtBQUFBLENBQUEsQUFBQztBQUdNLENBQUosRUFBSSxDQUFBLGdCQUFnQixFQUFHLEVBQUM7QUFBRSxDQUFBLGtCQUFlLEVBQUcsRUFBQyxDQUFDO0FBRWxELENBQUEsS0FBTSxRQUFRLEVBQUksVUFBVSxDQUFFO0FBQ3RCLENBQUosSUFBSSxDQUFBLE9BQU8sRUFBRyxDQUFBLE1BQU0sUUFBUSxDQUFDO0FBR3pCLENBQUosSUFBSSxDQUFBLE9BQU8sRUFBRyxDQUFBLE1BQU0sUUFBUSxDQUFDO0FBSTdCLENBQUEsT0FBTSxPQUFPLEVBQUUsQ0FBQztBQUVaLENBQUEsT0FBTSxPQUFPLEVBQUUsQ0FBQztDQUV2QixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBnbG9iYWxzID0ge1xyXG4gICAgYnVsbGV0czogbnVsbCxcclxuICAgIGVuZW1pZXM6IG51bGwsXHJcbiAgICBwbGF5ZXI6IG51bGxcclxufVxyXG52YXIgdXBkYXRlID0gcmVxdWlyZSgnLi9nYW1lL3VwZGF0ZScpO1xyXG52YXIgcHJlbG9hZCA9IHJlcXVpcmUoJy4vZ2FtZS9wcmVsb2FkJykgO1xyXG52YXIgY3JlYXRlID0gcmVxdWlyZSgnLi9nYW1lL2NyZWF0ZScpO1xyXG4gXHJcbnZhciBnYW1lID0gd2luZG93LmdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoODAwLCA2MDAsIFBoYXNlci5BVVRPLCAnJywgeyBwcmVsb2FkOiBwcmVsb2FkLCBjcmVhdGU6IGNyZWF0ZSwgdXBkYXRlOiB1cGRhdGUgfSk7XHJcbiIsIiBmdW5jdGlvbiByZXNldEJ1bGxldCAoYnVsbGV0KSB7XHJcblxyXG4gICAgYnVsbGV0LmtpbGwoKTtcclxuXHJcbn1cclxuO1xyXG5mdW5jdGlvbiBzZXR1cEVuZW15IChlbmVteSkge1xyXG5cclxuICAgIGVuZW15LmFuY2hvci54ID0gMC41O1xyXG4gICAgZW5lbXkuYW5jaG9yLnkgPSAwLjU7XHJcbiAgICBlbmVteS5hbmltYXRpb25zLmFkZCgnZXhwbG9kZScpO1xyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gICAgZnVuY3Rpb24oKXtcclxuXHJcbiAgICBnYW1lLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcclxuXHJcbiAgICB0aGlzLnNwYWNlQkcgPSAgdGhpcy5hZGQudGlsZVNwcml0ZSgwLCAwLCA4MDAsIDYwMCwgJ2JnJyk7ICBcclxuICAgIHRoaXMuc3BhY2VCRy5hdXRvU2Nyb2xsKDAsIDc1KTsgXHJcblxyXG5cclxuICAgIHdpbmRvdy5wbGF5ZXIgPSByZXF1aXJlKCcuL3BsYXllcicpKGdhbWUpO1xyXG4gICAgcGxheWVyLmluaXQoKTtcclxuICAgIHZhciBidWxsZXRzID0gd2luZG93LmJ1bGxldHMgPSB0aGlzLmFkZC5ncm91cCgpO1xyXG5cclxuICAgIGJ1bGxldHMuZW5hYmxlQm9keSA9IHRydWU7XHJcblxyXG4gICAgYnVsbGV0cy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcblxyXG4gICAgYnVsbGV0cy5jcmVhdGVNdWx0aXBsZSgxMCwgJ2J1bGxldHMnLCAnYnVsbGV0LWdyZWVuLnBuZycpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcclxuICAgIGJ1bGxldHMuc2V0QWxsKCdhbmNob3IueScsIDEpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ291dE9mQm91bmRzS2lsbCcsIHRydWUpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcclxuXHJcbiAgICBcclxuXHJcblxyXG4gICAgd2luZG93LmV4cGxvc2lvbnMgPSBnYW1lLmFkZC5ncm91cCgpO1xyXG4gICAgZXhwbG9zaW9ucy5jcmVhdGVNdWx0aXBsZSgzMCwgJ2V4cGxvZGUnKTtcclxuICAgIGV4cGxvc2lvbnMuZm9yRWFjaChzZXR1cEVuZW15LCB0aGlzKTtcclxuICAgIHdpbmRvdy5tdXNpYyA9IGdhbWUuYWRkLmF1ZGlvKCdzdGFnZS0xJyk7XHJcbiAgICB3aW5kb3cuYm9vbSA9IGdhbWUuYWRkLmF1ZGlvKCdib29tJyk7XHJcbiAgICB3aW5kb3cubGF6ZXIgPSBnYW1lLmFkZC5hdWRpbygnbGF6ZXInKTtcclxuXHJcbiAgICBcclxuICAgIHdpbmRvdy5zdGFnZTEgPSByZXF1aXJlKCcuL3NjZW5lcy9zY2VuZS0xJykoZ2FtZSk7XHJcbiAgICBzdGFnZTEuaW5pdCgpO1xyXG59XHJcblxyXG4gIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZ2FtZSkge1xyXG5cdHZhciBwbGF5ZXIsIGN1cnNvcnM7XHJcblx0dmFyIHJpZ2h0X2J1bGxldFRpbWUgPSAwLCBsZWZ0X2J1bGxldFRpbWUgPSAwOyBcclxuICAgIHZhciBwbGF5ZXJTcGVlZCA9IDIwMDsgLy9kdW5ub1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBmaXJlQnVsbGV0ICgpIHsgXHJcbiAgICAgICAgICAgIGlmICggZ2FtZS50aW1lLm5vdyA+IHJpZ2h0X2J1bGxldFRpbWUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciByaWdodF9idWxsZXQgPSBidWxsZXRzLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChyaWdodF9idWxsZXQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gIEFuZCBmaXJlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0LnJlc2V0KHBsYXllci54LCBwbGF5ZXIueSArIDE2KTtcclxuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQuYm9keS52ZWxvY2l0eS55ID0gLTMwMDtcclxuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXRUaW1lID0gZ2FtZS50aW1lLm5vdyArIDEwMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF6ZXIucGxheSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICggZ2FtZS50aW1lLm5vdyA+IGxlZnRfYnVsbGV0VGltZSArIDIwKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVmdF9idWxsZXQgPSBidWxsZXRzLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZWZ0X2J1bGxldClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgQW5kIGZpcmUgaXRcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5yZXNldChwbGF5ZXIueCArIDI2LCBwbGF5ZXIueSArIDE2KTtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5ib2R5LnZlbG9jaXR5LnkgPSAtMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRfYnVsbGV0VGltZSA9IGdhbWUudGltZS5ub3cgKyAxMDAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGxhemVyLnBsYXkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHBsYXllciA9IGdhbWUuYWRkLnNwcml0ZSgoNDAwIC0gMTYpLCA1MDAsICdzaGlwJyk7XHJcbiAgICBcdFx0Z2FtZS5waHlzaWNzLmVuYWJsZShwbGF5ZXIsIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcbiAgICBcdFx0Y3Vyc29ycyA9ICBnYW1lLmlucHV0LmtleWJvYXJkLmNyZWF0ZUN1cnNvcktleXMoKTtcclxuXHRcdH0sXHJcblx0XHR1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy9LRVlCT0FSRCBNT1ZFTUVOVFxyXG5cdCAgICAgICAgaWYgKGN1cnNvcnMudXAuaXNEb3duKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgIC8vICBJZiB0aGUgc2hpZnQga2V5IGlzIGFsc28gcHJlc3NlZCB0aGVuIHRoZSB3b3JsZCBpcyByb3RhdGVkXHJcblx0ICAgICAgICAgICAgaWYgKGN1cnNvcnMudXAuc2hpZnRLZXkpXHJcblx0ICAgICAgICAgICAge1xyXG5cdCAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gKz0gMC4wNTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZVxyXG5cdCAgICAgICAgICAgIHtcclxuXHQgICAgICAgICAgICAgICAgaWYocGxheWVyLnkgPiAzNTApIHBsYXllci55IC09IDQ7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZWxzZSBpZiAoY3Vyc29ycy5kb3duLmlzRG93bilcclxuXHQgICAgICAgIHtcclxuXHQgICAgICAgICAgICBpZiAoY3Vyc29ycy5kb3duLnNoaWZ0S2V5KVxyXG5cdCAgICAgICAgICAgIHtcclxuXHQgICAgICAgICAgICAgICAgLy9nYW1lLndvcmxkLnJvdGF0aW9uIC09IDAuMDU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2VcclxuXHQgICAgICAgICAgICB7XHJcblx0ICAgICAgICAgICAgICAgIHBsYXllci55ICs9IDQ7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgaWYgKGN1cnNvcnMubGVmdC5pc0Rvd24pXHJcblx0ICAgICAgICB7XHJcblx0ICAgICAgICAgICAgcGxheWVyLnggLT0gNDtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2UgaWYgKGN1cnNvcnMucmlnaHQuaXNEb3duKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgcGxheWVyLnggKz0gNDtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGlmIChnYW1lLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuU1BBQ0VCQVIpKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgIGZpcmVCdWxsZXQoKSA7XHJcblx0ICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgLy9HQU1FUEFEIFNVUFBPUlRcclxuICAgICAgICAgICAgaWYgKGdhbWUuaW5wdXQuam95c3RpY2tMZWZ0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBNb3ZlIHRoZSB1Zm8gdXNpbmcgdGhlIGpveXN0aWNrJ3Mgbm9ybWFsaXplZFggYW5kIFkgdmFsdWVzLFxyXG4gICAgICAgICAgICAgICAgLy8gd2hpY2ggcmFuZ2UgZnJvbSAtMSB0byAxLlxyXG4gICAgICAgICAgICAgICAgcGxheWVyLmJvZHkudmVsb2NpdHkuc2V0VG8oZ2FtZS5pbnB1dC5qb3lzdGlja0xlZnQubm9ybWFsaXplZFggKiAyMDAsIGdhbWUuaW5wdXQuam95c3RpY2tMZWZ0Lm5vcm1hbGl6ZWRZICogcGxheWVyU3BlZWQgKiAtMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXIuYm9keS52ZWxvY2l0eS5zZXRUbygwLCAwKTtcclxuICAgICAgICAgICAgfVxyXG5cdFx0fVxyXG5cdH1cclxufSIsIm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcclxuIFxyXG4gICAgdGhpcy5sb2FkLmF0bGFzKCdidWxsZXRzJywgJ2ltZy9hc3NldHMvYnVsbGV0cy5wbmcnLCAnaW1nL2Fzc2V0cy9idWxsZXRzLmpzb24nKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnYmx1ZV9idWxsZXQnLCAnaW1nL2Fzc2V0cy9ibHVlLWJ1bGxldC5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnYmcnLCAnaW1nL2JhY2tncm91bmRzL2JnLnBuZycpOyBcclxuICAgIHRoaXMubG9hZC5hdGxhcygnYXRsYXMnLCAnaW1nL2VuZW15LWZpZ2h0ZXJzL2VuZW15LWZpZ2h0ZXJzLnBuZycsICdpbWcvZW5lbXktZmlnaHRlcnMvZW5lbXktZmlnaHRlcnMuanNvbicpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdzaGlwJywgJ2ltZy9zcGFjZV9zaGlwX2Jhc2UucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2V4cGxvZGUnLCAnaW1nL2Fzc2V0cy9leHBsb2RlLnBuZycsIDEyOCwgMTI4KTtcclxuICAgIHRoaXMubG9hZC5hdWRpbygnYm9vbScsIFsnYXVkaW8vZWZmZWN0cy9leHBsb2RlLndhdiddKTtcclxuICAgIHRoaXMubG9hZC5hdWRpbygnbGF6ZXInLCBbJ2F1ZGlvL2VmZmVjdHMvbGF6ZXIud2F2J10pO1xyXG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdzdGFnZS0xJywgWydhdWRpby9iYWNrZ3JvdW5kL3N0YWdlLTEubXAzJywgJ2F1ZGlvL2JhY2tncm91bmQvc3RhZ2UtMS5vZ2cnXSk7XHJcblxyXG59IiwibW9kdWxlLmV4cG9ydHMgPSAgZnVuY3Rpb24gKGdhbWUpIHtcclxuXHR2YXIgcmFwdG9ycztcclxuICAgIHZhciBzcGF3biA9IGZ1bmN0aW9uICgpIHsgXHJcblxyXG4gICAgICAgIHZhciB4ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoNDAsIDYwMCkgICwgeSA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEwKTtcclxuICAgICAgICB2YXIgX2FsaWVuID0gYWxpZW5zLmNyZWF0ZSh4LCB5LCAnYXRsYXMnLCAnYmFkLWd1eTEucG5nJyk7XHJcbiAgICAgICAgX2FsaWVuLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiBcclxuICAgICAgICBfYWxpZW4uYm9keS5tb3ZlcyA9IHRydWU7XHJcbiAgICAgICAgX2FsaWVuLmJvZHkudmVsb2NpdHkuc2V0VG8oMCwgMTAwKSA7IFxyXG4gICAgfTtcclxuXHJcblx0dmFyIGNvbGxpc2lvbkhhbmRsZXIgPSBmdW5jdGlvbiAgKGJ1bGxldCwgYWxpZW4pIHtcclxuXHJcblx0ICAgIGJ1bGxldC5raWxsKCk7XHJcblx0ICAgIGFsaWVuLmtpbGwoKTtcclxuXHQgICAgd2luZG93LmJvb20ucGxheSgpO1xyXG5cdCAgICB2YXIgeCA9IGFsaWVuLmJvZHkueCwgeSA9YWxpZW4uYm9keS55XHJcblx0ICAgIHZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuXHQgICAgZXhwbG9zaW9uLnJlc2V0KGFsaWVuLmJvZHkueCwgYWxpZW4uYm9keS55KTtcclxuXHQgICAgZXhwbG9zaW9uLnBsYXkoJ2V4cGxvZGUnLCAzMCwgZmFsc2UsIHRydWUpO1xyXG5cdH07XHJcblxyXG4gICAgdmFyIHNwYXduUmFwdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgXHR2YXIgeCA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDQwLCA2MDApICAsIHkgPSBnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSgwLCAxMCk7XHJcbiAgICAgICAgdmFyIF9hbGllbiA9IHJhcHRvcnMuY3JlYXRlKHgsIHksICdhdGxhcycsICdyYXB0b3ItMS5wbmcnKTtcclxuICAgICAgICBfYWxpZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuIFxyXG4gICAgICAgIF9hbGllbi5ib2R5Lm1vdmVzID0gdHJ1ZTtcclxuICAgICAgICBfYWxpZW4uYm9keS52ZWxvY2l0eS5zZXRUbygwLCAxNTApIDsgXHJcbiAgICB9XHJcblx0dmFyIGVuZW15RmFjdG9yeTtcclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0d2luZG93LmFsaWVucyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcbiAgICBcdFx0YWxpZW5zLmVuYWJsZUJvZHkgPSB0cnVlO1xyXG4gICAgXHRcdGFsaWVucy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcbiAgICBcdFx0cmFwdG9ycyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcbiAgICBcdFx0cmFwdG9ycy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuICAgIFx0XHRyYXB0b3JzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuXHRcdCAgICBtdXNpYy5wbGF5KCcnLCAwLCAxLCB0cnVlKTtcclxuXHJcbiAgICBcdFx0Z2FtZS50aW1lLmV2ZW50cy5yZXBlYXQoUGhhc2VyLlRpbWVyLlNFQ09ORCAqIDIsIDEwNSwgc3Bhd24sIHRoaXMpO1xyXG5cclxuICAgIFx0XHRnYW1lLnRpbWUuZXZlbnRzLnJlcGVhdChQaGFzZXIuVGltZXIuU0VDT05EICogOCwgMjAsIHNwYXduUmFwdG9yLCB0aGlzKTtcclxuXHRcdH0sXHJcblx0XHR1cGRhdGUgOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdC8vZ2FtZSBsb29wIGZvciB0aGUgc3RhZ2VcclxuXHRcdFx0Z2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKGJ1bGxldHMsIGFsaWVucywgY29sbGlzaW9uSGFuZGxlciwgbnVsbCwgdGhpcyk7XHJcblx0XHRcdGdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcChidWxsZXRzLCByYXB0b3JzLCBjb2xsaXNpb25IYW5kbGVyLCBudWxsLCB0aGlzKTtcclxuXHRcdH0sXHJcblx0XHRkZXN0cm95OiBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0fVxyXG5cdH1cclxufSIsInZhciBidWxsZXRUaW1lID0gMDtcclxuIGZ1bmN0aW9uIHJlc2V0QnVsbGV0IChidWxsZXQpIHtcclxuXHJcbiAgICBidWxsZXQua2lsbCgpO1xyXG5cclxufTtcclxuXHJcbiBcclxuICAgIHZhciByaWdodF9idWxsZXRUaW1lID0gMCwgbGVmdF9idWxsZXRUaW1lID0gMDsgXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9ICBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYnVsbGV0cyA9IHdpbmRvdy5idWxsZXRzO1xyXG5cclxuICAgIFxyXG4gICAgdmFyIGN1cnNvcnMgPSB3aW5kb3cuY3Vyc29yczsgXHJcblxyXG5cclxuXHJcbiAgICBwbGF5ZXIudXBkYXRlKCk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhjdXJzb3JzKTtcclxuICAgICAgICBzdGFnZTEudXBkYXRlKCk7XHJcbiAgICAgICAgXHJcbn07XHJcbiJdfQ==
