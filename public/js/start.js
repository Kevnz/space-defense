(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var globals = {
  bullets: null,
  enemies: null,
  player: null
};
var update = require('./game/update');
var preload = require('./game/preload');
var create = require('./game/create');
var game = window.game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
  preload: preload,
  create: create,
  update: update
});


},{"./game/create":2,"./game/preload":4,"./game/update":6}],2:[function(require,module,exports){
"use strict";
function resetBullet(bullet) {
  bullet.kill();
}
;
function setupEnemy(enemy) {
  enemy.anchor.x = 0.5;
  enemy.anchor.y = 0.5;
  enemy.animations.add('explode');
}
;
module.exports = function() {
  game.physics.startSystem(Phaser.Physics.ARCADE);
  this.spaceBG = this.add.tileSprite(0, 0, 800, 600, 'bg');
  this.spaceBG.autoScroll(0, 75);
  window.player = require('./player')(game);
  player.init();
  var bullets = window.bullets = this.add.group();
  bullets.enableBody = true;
  bullets.physicsBodyType = Phaser.Physics.ARCADE;
  bullets.createMultiple(10, 'bullets', 'bullet-green.png');
  bullets.setAll('anchor.x', 0.5);
  bullets.setAll('anchor.y', 1);
  bullets.setAll('outOfBoundsKill', true);
  bullets.setAll('checkWorldBounds', true);
  window.explosions = game.add.group();
  explosions.createMultiple(30, 'explode');
  explosions.forEach(setupEnemy, this);
  window.music = game.add.audio('stage-1');
  window.boom = game.add.audio('boom');
  window.lazer = game.add.audio('lazer');
  window.stage1 = require('./scenes/scene-1')(game);
  stage1.init();
};


},{"./player":3,"./scenes/scene-1":5}],3:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var player,
      cursors;
  var right_bulletTime = 0,
      left_bulletTime = 0;
  function fireBullet() {
    if (game.time.now > right_bulletTime) {
      var right_bullet = bullets.getFirstExists(false);
      if (right_bullet) {
        right_bullet.reset(player.x, player.y + 16);
        right_bullet.body.velocity.y = -300;
        right_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
    if (game.time.now > left_bulletTime + 20) {
      var left_bullet = bullets.getFirstExists(false);
      if (left_bullet) {
        left_bullet.reset(player.x + 26, player.y + 16);
        left_bullet.body.velocity.y = -300;
        left_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
  }
  return {
    init: function() {
      player = game.add.sprite((400 - 16), 500, 'ship');
      game.physics.enable(player, Phaser.Physics.ARCADE);
      cursors = game.input.keyboard.createCursorKeys();
    },
    update: function() {
      if (cursors.up.isDown) {
        if (cursors.up.shiftKey) {} else {
          if (player.y > 350)
            player.y -= 4;
        }
      } else if (cursors.down.isDown) {
        if (cursors.down.shiftKey) {} else {
          player.y += 4;
        }
      }
      if (cursors.left.isDown) {
        player.x -= 4;
      } else if (cursors.right.isDown) {
        player.x += 4;
      }
      if (game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {
        fireBullet();
      }
    }
  };
};


},{}],4:[function(require,module,exports){
"use strict";
module.exports = function() {
  this.load.atlas('bullets', 'img/assets/bullets.png', 'img/assets/bullets.json');
  this.load.image('blue_bullet', 'img/assets/blue-bullet.png');
  this.load.image('bg', 'img/backgrounds/bg.png');
  this.load.atlas('atlas', 'img/enemy-fighters/enemy-fighters.png', 'img/enemy-fighters/enemy-fighters.json');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.spritesheet('explode', 'img/assets/explode.png', 128, 128);
  this.load.audio('boom', ['audio/effects/explode.wav']);
  this.load.audio('lazer', ['audio/effects/lazer.wav']);
  this.load.audio('stage-1', ['audio/background/stage-1.mp3', 'audio/background/stage-1.ogg']);
};


},{}],5:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var raptors;
  var spawn = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = aliens.create(x, y, 'atlas', 'bad-guy1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 100);
  };
  var collisionHandler = function(bullet, alien) {
    bullet.kill();
    alien.kill();
    window.boom.play();
    var x = alien.body.x,
        y = alien.body.y;
    var explosion = explosions.getFirstExists(false);
    explosion.reset(alien.body.x, alien.body.y);
    explosion.play('explode', 30, false, true);
  };
  var spawnRaptor = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = raptors.create(x, y, 'atlas', 'raptor-1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 150);
  };
  var enemyFactory;
  return {
    init: function() {
      window.aliens = game.add.group();
      aliens.enableBody = true;
      aliens.physicsBodyType = Phaser.Physics.ARCADE;
      raptors = game.add.group();
      raptors.enableBody = true;
      raptors.physicsBodyType = Phaser.Physics.ARCADE;
      music.play('', 0, 1, true);
      game.time.events.repeat(Phaser.Timer.SECOND * 2, 105, spawn, this);
      game.time.events.repeat(Phaser.Timer.SECOND * 8, 20, spawnRaptor, this);
    },
    update: function() {
      game.physics.arcade.overlap(bullets, aliens, collisionHandler, null, this);
      game.physics.arcade.overlap(bullets, raptors, collisionHandler, null, this);
    },
    destroy: function() {}
  };
};


},{}],6:[function(require,module,exports){
"use strict";
var bulletTime = 0;
function resetBullet(bullet) {
  bullet.kill();
}
;
var right_bulletTime = 0,
    left_bulletTime = 0;
module.exports = function() {
  var bullets = window.bullets;
  var cursors = window.cursors;
  player.update();
  stage1.update();
};


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZS5qcyIsIkM6XFxVc2Vyc1xcS2V2aW5cXFByb2plY3RzXFxzcGFjZS1kZWZlbnNlXFxwdWJsaWNcXGpzXFxnYW1lXFxjcmVhdGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZVxccGxheWVyLmpzIiwiQzpcXFVzZXJzXFxLZXZpblxcUHJvamVjdHNcXHNwYWNlLWRlZmVuc2VcXHB1YmxpY1xcanNcXGdhbWVcXHByZWxvYWQuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZVxcc2NlbmVzXFxzY2VuZS0xLmpzIiwiQzpcXFVzZXJzXFxLZXZpblxcUHJvamVjdHNcXHNwYWNlLWRlZmVuc2VcXHB1YmxpY1xcanNcXGdhbWVcXHVwZGF0ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQUksQ0FBSixFQUFJLENBQUEsT0FBTyxFQUFHO0FBQ1YsQ0FBQSxRQUFPLENBQUUsS0FBSTtBQUNiLENBQUEsUUFBTyxDQUFFLEtBQUk7QUFDYixDQUFBLE9BQU0sQ0FBRSxLQUFJO0NBQUEsQUFDZixDQUFBO0FBQ0csQ0FBSixFQUFJLENBQUEsTUFBTSxFQUFHLENBQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ2xDLENBQUosRUFBSSxDQUFBLE9BQU8sRUFBRyxDQUFBLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFFO0FBQ3JDLENBQUosRUFBSSxDQUFBLE1BQU0sRUFBRyxDQUFBLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUVsQyxDQUFKLEVBQUksQ0FBQSxJQUFJLEVBQUcsQ0FBQSxNQUFNLEtBQUssRUFBRyxJQUFJLENBQUEsTUFBTSxLQUFLLENBQUMsR0FBRyxDQUFFLElBQUcsQ0FBRSxDQUFBLE1BQU0sS0FBSyxDQUFFLEdBQUUsQ0FBRTtBQUFFLENBQUEsUUFBTyxDQUFFLFFBQU87QUFBRSxDQUFBLE9BQU0sQ0FBRSxPQUFNO0FBQUUsQ0FBQSxPQUFNLENBQUUsT0FBTTtDQUFBLEFBQUUsQ0FBQyxDQUFDO0NBQzFIOzs7QUNWQztDQUFBLE9BQVMsWUFBVyxDQUFFLE1BQU0sQ0FBRTtBQUUzQixDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7Q0FFakI7QUFDRCxDQURDLEFBQ0E7Q0FDRCxPQUFTLFdBQVUsQ0FBRSxLQUFLLENBQUU7QUFFeEIsQ0FBQSxNQUFLLE9BQU8sRUFBRSxFQUFHLElBQUcsQ0FBQztBQUNyQixDQUFBLE1BQUssT0FBTyxFQUFFLEVBQUcsSUFBRyxDQUFDO0FBQ3JCLENBQUEsTUFBSyxXQUFXLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztDQUVuQztBQUFBLENBQUEsQUFBQztBQUVGLENBQUEsS0FBTSxRQUFRLEVBQU0sVUFBUyxDQUFDO0FBRTFCLENBQUEsS0FBSSxRQUFRLFlBQVksQ0FBQyxNQUFNLFFBQVEsT0FBTyxDQUFDLENBQUM7QUFFaEQsQ0FBQSxLQUFJLFFBQVEsRUFBSSxDQUFBLElBQUksSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFFLEVBQUMsQ0FBRSxJQUFHLENBQUUsSUFBRyxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBQzFELENBQUEsS0FBSSxRQUFRLFdBQVcsQ0FBQyxDQUFDLENBQUUsR0FBRSxDQUFDLENBQUM7QUFHL0IsQ0FBQSxPQUFNLE9BQU8sRUFBRyxDQUFBLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMxQyxDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7QUFDVixDQUFKLElBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxNQUFNLFFBQVEsRUFBRyxDQUFBLElBQUksSUFBSSxNQUFNLEVBQUUsQ0FBQztBQUVoRCxDQUFBLFFBQU8sV0FBVyxFQUFHLEtBQUksQ0FBQztBQUUxQixDQUFBLFFBQU8sZ0JBQWdCLEVBQUcsQ0FBQSxNQUFNLFFBQVEsT0FBTyxDQUFDO0FBRWhELENBQUEsUUFBTyxlQUFlLENBQUMsRUFBRSxDQUFFLFVBQVMsQ0FBRSxtQkFBa0IsQ0FBQyxDQUFDO0FBQzFELENBQUEsUUFBTyxPQUFPLENBQUMsVUFBVSxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBQ2hDLENBQUEsUUFBTyxPQUFPLENBQUMsVUFBVSxDQUFFLEVBQUMsQ0FBQyxDQUFDO0FBQzlCLENBQUEsUUFBTyxPQUFPLENBQUMsaUJBQWlCLENBQUUsS0FBSSxDQUFDLENBQUM7QUFDeEMsQ0FBQSxRQUFPLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBRSxLQUFJLENBQUMsQ0FBQztBQUt6QyxDQUFBLE9BQU0sV0FBVyxFQUFHLENBQUEsSUFBSSxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQ3JDLENBQUEsV0FBVSxlQUFlLENBQUMsRUFBRSxDQUFFLFVBQVMsQ0FBQyxDQUFDO0FBQ3pDLENBQUEsV0FBVSxRQUFRLENBQUMsVUFBVSxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBQ3JDLENBQUEsT0FBTSxNQUFNLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3pDLENBQUEsT0FBTSxLQUFLLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3JDLENBQUEsT0FBTSxNQUFNLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBR3ZDLENBQUEsT0FBTSxPQUFPLEVBQUcsQ0FBQSxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsRCxDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7Q0FDakIsQ0FBQTtDQUVBOzs7QUNuREQ7QUFBQSxDQUFBLEtBQU0sUUFBUSxFQUFHLFVBQVUsSUFBSSxDQUFFO0FBQzVCLENBQUosSUFBSSxDQUFBLE1BQU07QUFBRSxDQUFBLFlBQU8sQ0FBQztBQUNoQixDQUFKLElBQUksQ0FBQSxnQkFBZ0IsRUFBRyxFQUFDO0FBQUUsQ0FBQSxvQkFBZSxFQUFHLEVBQUMsQ0FBQztDQUN2QyxTQUFTLFdBQVUsQ0FBRSxDQUFFO0NBQ25CLE9BQUssSUFBSSxLQUFLLElBQUksRUFBRyxpQkFBZ0IsQ0FDckM7QUFDUSxDQUFKLFFBQUksQ0FBQSxZQUFZLEVBQUcsQ0FBQSxPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztDQUNqRCxTQUFJLFlBQVksQ0FDaEI7QUFFSSxDQUFBLG1CQUFZLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBRSxDQUFBLE1BQU0sRUFBRSxFQUFHLEdBQUUsQ0FBQyxDQUFDO0FBQzVDLENBQUEsbUJBQVksS0FBSyxTQUFTLEVBQUUsRUFBRyxFQUFDLEdBQUcsQ0FBQztBQUNwQyxDQUFBLHVCQUFnQixFQUFHLENBQUEsSUFBSSxLQUFLLElBQUksRUFBRyxLQUFJLENBQUM7QUFDeEMsQ0FBQSxZQUFLLEtBQUssRUFBRSxDQUFDO09BQ2hCO0NBQUEsSUFDSjtBQUNELENBREMsT0FDSSxJQUFJLEtBQUssSUFBSSxFQUFHLENBQUEsZUFBZSxFQUFHLEdBQUUsQ0FDekM7QUFDUSxDQUFKLFFBQUksQ0FBQSxXQUFXLEVBQUcsQ0FBQSxPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztDQUNoRCxTQUFJLFdBQVcsQ0FDZjtBQUVJLENBQUEsa0JBQVcsTUFBTSxDQUFDLE1BQU0sRUFBRSxFQUFHLEdBQUUsQ0FBRSxDQUFBLE1BQU0sRUFBRSxFQUFHLEdBQUUsQ0FBQyxDQUFDO0FBQ2hELENBQUEsa0JBQVcsS0FBSyxTQUFTLEVBQUUsRUFBRyxFQUFDLEdBQUcsQ0FBQztBQUNuQyxDQUFBLHNCQUFlLEVBQUcsQ0FBQSxJQUFJLEtBQUssSUFBSSxFQUFHLEtBQUksQ0FBQztBQUN2QyxDQUFBLFlBQUssS0FBSyxFQUFFLENBQUM7T0FDaEI7Q0FBQSxJQUNKO0NBQUEsRUFDSjtBQUVSLENBRlEsT0FFRDtBQUNOLENBQUEsT0FBSSxDQUFHLFVBQVUsQ0FBRTtBQUNsQixDQUFBLFdBQU0sRUFBRyxDQUFBLElBQUksSUFBSSxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUcsR0FBRSxDQUFDLENBQUUsSUFBRyxDQUFFLE9BQU0sQ0FBQyxDQUFDO0FBQy9DLENBQUEsU0FBSSxRQUFRLE9BQU8sQ0FBQyxNQUFNLENBQUUsQ0FBQSxNQUFNLFFBQVEsT0FBTyxDQUFDLENBQUM7QUFDbkQsQ0FBQSxZQUFPLEVBQUksQ0FBQSxJQUFJLE1BQU0sU0FBUyxpQkFBaUIsRUFBRSxDQUFDO0tBQ3JEO0FBQ0QsQ0FBQSxTQUFNLENBQUUsVUFBVSxDQUFFO0NBRWIsU0FBSSxPQUFPLEdBQUcsT0FBTyxDQUNyQjtDQUVJLFdBQUksT0FBTyxHQUFHLFNBQVMsQ0FDdkIsR0FFQyxLQUVEO0NBQ0ksYUFBRyxNQUFNLEVBQUUsRUFBRyxJQUFHO0FBQUUsQ0FBQSxpQkFBTSxFQUFFLEdBQUksRUFBQyxDQUFDO0NBQUEsUUFDcEM7Q0FBQSxNQUNKLEtBQ0ksS0FBSSxPQUFPLEtBQUssT0FBTyxDQUM1QjtDQUNJLFdBQUksT0FBTyxLQUFLLFNBQVMsQ0FDekIsR0FFQyxLQUVEO0FBQ0ksQ0FBQSxlQUFNLEVBQUUsR0FBSSxFQUFDLENBQUM7U0FDakI7Q0FBQSxNQUNKO0FBQ0QsQ0FEQyxTQUNHLE9BQU8sS0FBSyxPQUFPLENBQ3ZCO0FBQ0ksQ0FBQSxhQUFNLEVBQUUsR0FBSSxFQUFDLENBQUM7T0FDakIsS0FDSSxLQUFJLE9BQU8sTUFBTSxPQUFPLENBQzdCO0FBQ0csQ0FBQSxhQUFNLEVBQUUsR0FBSSxFQUFDLENBQUM7T0FDaEI7QUFDRCxDQURDLFNBQ0csSUFBSSxNQUFNLFNBQVMsT0FBTyxDQUFDLE1BQU0sU0FBUyxTQUFTLENBQUMsQ0FDeEQ7QUFDSSxDQUFBLGlCQUFVLEVBQUUsQ0FBRTtPQUNqQjtDQUFBLElBQ1A7Q0FBQSxFQUNELENBQUE7Q0FDRCxDQUFBO0NBQUE7OztBQzNFRDtBQUFBLENBQUEsS0FBTSxRQUFRLEVBQUksVUFBVSxDQUFFO0FBRTFCLENBQUEsS0FBSSxLQUFLLE1BQU0sQ0FBQyxTQUFTLENBQUUseUJBQXdCLENBQUUsMEJBQXlCLENBQUMsQ0FBQztBQUNoRixDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsYUFBYSxDQUFFLDZCQUE0QixDQUFDLENBQUM7QUFDN0QsQ0FBQSxLQUFJLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBRSx5QkFBd0IsQ0FBQyxDQUFDO0FBQ2hELENBQUEsS0FBSSxLQUFLLE1BQU0sQ0FBQyxPQUFPLENBQUUsd0NBQXVDLENBQUUseUNBQXdDLENBQUMsQ0FBQztBQUM1RyxDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsTUFBTSxDQUFFLDBCQUF5QixDQUFDLENBQUM7QUFDbkQsQ0FBQSxLQUFJLEtBQUssWUFBWSxDQUFDLFNBQVMsQ0FBRSx5QkFBd0IsQ0FBRSxJQUFHLENBQUUsSUFBRyxDQUFDLENBQUM7QUFDckUsQ0FBQSxLQUFJLEtBQUssTUFBTSxDQUFDLE1BQU0sQ0FBRSxFQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FBQztBQUN2RCxDQUFBLEtBQUksS0FBSyxNQUFNLENBQUMsT0FBTyxDQUFFLEVBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDO0FBQ3RELENBQUEsS0FBSSxLQUFLLE1BQU0sQ0FBQyxTQUFTLENBQUUsRUFBQyw4QkFBOEIsQ0FBRSwrQkFBOEIsQ0FBQyxDQUFDLENBQUM7Q0FFaEcsQ0FBQTtDQUFBOzs7QUNaRDtBQUFBLENBQUEsS0FBTSxRQUFRLEVBQUksVUFBVSxJQUFJLENBQUU7QUFDN0IsQ0FBSixJQUFJLENBQUEsT0FBTyxDQUFDO0FBQ0wsQ0FBSixJQUFJLENBQUEsS0FBSyxFQUFHLFVBQVUsQ0FBRTtBQUVoQixDQUFKLE1BQUksQ0FBQSxDQUFDLEVBQUcsQ0FBQSxJQUFJLElBQUksZUFBZSxDQUFDLEVBQUUsQ0FBRSxJQUFHLENBQUM7QUFBSSxDQUFBLFFBQUMsRUFBRyxDQUFBLElBQUksSUFBSSxlQUFlLENBQUMsQ0FBQyxDQUFFLEdBQUUsQ0FBQyxDQUFDO0FBQzNFLENBQUosTUFBSSxDQUFBLE1BQU0sRUFBRyxDQUFBLE1BQU0sT0FBTyxDQUFDLENBQUMsQ0FBRSxFQUFDLENBQUUsUUFBTyxDQUFFLGVBQWMsQ0FBQyxDQUFDO0FBQzFELENBQUEsU0FBTSxPQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUUsSUFBRyxDQUFDLENBQUM7QUFFOUIsQ0FBQSxTQUFNLEtBQUssTUFBTSxFQUFHLEtBQUksQ0FBQztBQUN6QixDQUFBLFNBQU0sS0FBSyxTQUFTLE1BQU0sQ0FBQyxDQUFDLENBQUUsSUFBRyxDQUFDLENBQUU7R0FDdkMsQ0FBQztBQUVELENBQUosSUFBSSxDQUFBLGdCQUFnQixFQUFHLFVBQVcsTUFBTSxDQUFFLENBQUEsS0FBSyxDQUFFO0FBRTdDLENBQUEsU0FBTSxLQUFLLEVBQUUsQ0FBQztBQUNkLENBQUEsUUFBSyxLQUFLLEVBQUUsQ0FBQztBQUNiLENBQUEsU0FBTSxLQUFLLEtBQUssRUFBRSxDQUFDO0FBQ2YsQ0FBSixNQUFJLENBQUEsQ0FBQyxFQUFHLENBQUEsS0FBSyxLQUFLLEVBQUU7QUFBRSxDQUFBLFFBQUMsRUFBRSxDQUFBLEtBQUssS0FBSyxFQUFFLENBQUE7QUFDakMsQ0FBSixNQUFJLENBQUEsU0FBUyxFQUFHLENBQUEsVUFBVSxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDakQsQ0FBQSxZQUFTLE1BQU0sQ0FBQyxLQUFLLEtBQUssRUFBRSxDQUFFLENBQUEsS0FBSyxLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQzVDLENBQUEsWUFBUyxLQUFLLENBQUMsU0FBUyxDQUFFLEdBQUUsQ0FBRSxNQUFLLENBQUUsS0FBSSxDQUFDLENBQUM7R0FDOUMsQ0FBQztBQUVLLENBQUosSUFBSSxDQUFBLFdBQVcsRUFBRyxVQUFVLENBQUU7QUFDekIsQ0FBSixNQUFJLENBQUEsQ0FBQyxFQUFHLENBQUEsSUFBSSxJQUFJLGVBQWUsQ0FBQyxFQUFFLENBQUUsSUFBRyxDQUFDO0FBQUksQ0FBQSxRQUFDLEVBQUcsQ0FBQSxJQUFJLElBQUksZUFBZSxDQUFDLENBQUMsQ0FBRSxHQUFFLENBQUMsQ0FBQztBQUN4RSxDQUFKLE1BQUksQ0FBQSxNQUFNLEVBQUcsQ0FBQSxPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUUsRUFBQyxDQUFFLFFBQU8sQ0FBRSxlQUFjLENBQUMsQ0FBQztBQUMzRCxDQUFBLFNBQU0sT0FBTyxNQUFNLENBQUMsR0FBRyxDQUFFLElBQUcsQ0FBQyxDQUFDO0FBRTlCLENBQUEsU0FBTSxLQUFLLE1BQU0sRUFBRyxLQUFJLENBQUM7QUFDekIsQ0FBQSxTQUFNLEtBQUssU0FBUyxNQUFNLENBQUMsQ0FBQyxDQUFFLElBQUcsQ0FBQyxDQUFFO0dBQ3ZDLENBQUE7QUFDQSxDQUFKLElBQUksQ0FBQSxZQUFZLENBQUM7Q0FFakIsT0FBTztBQUNOLENBQUEsT0FBSSxDQUFFLFVBQVUsQ0FBRTtBQUNqQixDQUFBLFdBQU0sT0FBTyxFQUFHLENBQUEsSUFBSSxJQUFJLE1BQU0sRUFBRSxDQUFDO0FBQzlCLENBQUEsV0FBTSxXQUFXLEVBQUcsS0FBSSxDQUFDO0FBQ3pCLENBQUEsV0FBTSxnQkFBZ0IsRUFBRyxDQUFBLE1BQU0sUUFBUSxPQUFPLENBQUM7QUFDL0MsQ0FBQSxZQUFPLEVBQUcsQ0FBQSxJQUFJLElBQUksTUFBTSxFQUFFLENBQUM7QUFDM0IsQ0FBQSxZQUFPLFdBQVcsRUFBRyxLQUFJLENBQUM7QUFDMUIsQ0FBQSxZQUFPLGdCQUFnQixFQUFHLENBQUEsTUFBTSxRQUFRLE9BQU8sQ0FBQztBQUNoRCxDQUFBLFVBQUssS0FBSyxDQUFDLEVBQUUsQ0FBRSxFQUFDLENBQUUsRUFBQyxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBRTNCLENBQUEsU0FBSSxLQUFLLE9BQU8sT0FBTyxDQUFDLE1BQU0sTUFBTSxPQUFPLEVBQUcsRUFBQyxDQUFFLElBQUcsQ0FBRSxNQUFLLENBQUUsS0FBSSxDQUFDLENBQUM7QUFFbkUsQ0FBQSxTQUFJLEtBQUssT0FBTyxPQUFPLENBQUMsTUFBTSxNQUFNLE9BQU8sRUFBRyxFQUFDLENBQUUsR0FBRSxDQUFFLFlBQVcsQ0FBRSxLQUFJLENBQUMsQ0FBQztLQUMzRTtBQUNELENBQUEsU0FBTSxDQUFHLFVBQVUsQ0FBRTtBQUVwQixDQUFBLFNBQUksUUFBUSxPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUUsT0FBTSxDQUFFLGlCQUFnQixDQUFFLEtBQUksQ0FBRSxLQUFJLENBQUMsQ0FBQztBQUMzRSxDQUFBLFNBQUksUUFBUSxPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUUsUUFBTyxDQUFFLGlCQUFnQixDQUFFLEtBQUksQ0FBRSxLQUFJLENBQUMsQ0FBQztLQUM1RTtBQUNELENBQUEsVUFBTyxDQUFFLFVBQVUsQ0FBRSxHQUVwQjtDQUFBLEVBQ0QsQ0FBQTtDQUNELENBQUE7Q0FBQTs7O0FDeEREO0FBQUksQ0FBSixFQUFJLENBQUEsVUFBVSxFQUFHLEVBQUMsQ0FBQztDQUNsQixPQUFTLFlBQVcsQ0FBRSxNQUFNLENBQUU7QUFFM0IsQ0FBQSxPQUFNLEtBQUssRUFBRSxDQUFDO0NBRWpCO0FBQUEsQ0FBQSxBQUFDO0FBR00sQ0FBSixFQUFJLENBQUEsZ0JBQWdCLEVBQUcsRUFBQztBQUFFLENBQUEsa0JBQWUsRUFBRyxFQUFDLENBQUM7QUFFbEQsQ0FBQSxLQUFNLFFBQVEsRUFBSSxVQUFVLENBQUU7QUFDdEIsQ0FBSixJQUFJLENBQUEsT0FBTyxFQUFHLENBQUEsTUFBTSxRQUFRLENBQUM7QUFHekIsQ0FBSixJQUFJLENBQUEsT0FBTyxFQUFHLENBQUEsTUFBTSxRQUFRLENBQUM7QUFJN0IsQ0FBQSxPQUFNLE9BQU8sRUFBRSxDQUFDO0FBRVosQ0FBQSxPQUFNLE9BQU8sRUFBRSxDQUFDO0NBRXZCLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKX12YXIgZj1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwoZi5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxmLGYuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIGdsb2JhbHMgPSB7XHJcbiAgICBidWxsZXRzOiBudWxsLFxyXG4gICAgZW5lbWllczogbnVsbCxcclxuICAgIHBsYXllcjogbnVsbFxyXG59XHJcbnZhciB1cGRhdGUgPSByZXF1aXJlKCcuL2dhbWUvdXBkYXRlJyk7XHJcbnZhciBwcmVsb2FkID0gcmVxdWlyZSgnLi9nYW1lL3ByZWxvYWQnKSA7XHJcbnZhciBjcmVhdGUgPSByZXF1aXJlKCcuL2dhbWUvY3JlYXRlJyk7XHJcbiBcclxudmFyIGdhbWUgPSB3aW5kb3cuZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZSg4MDAsIDYwMCwgUGhhc2VyLkFVVE8sICcnLCB7IHByZWxvYWQ6IHByZWxvYWQsIGNyZWF0ZTogY3JlYXRlLCB1cGRhdGU6IHVwZGF0ZSB9KTtcclxuIiwiIGZ1bmN0aW9uIHJlc2V0QnVsbGV0IChidWxsZXQpIHtcclxuXHJcbiAgICBidWxsZXQua2lsbCgpO1xyXG5cclxufVxyXG47XHJcbmZ1bmN0aW9uIHNldHVwRW5lbXkgKGVuZW15KSB7XHJcblxyXG4gICAgZW5lbXkuYW5jaG9yLnggPSAwLjU7XHJcbiAgICBlbmVteS5hbmNob3IueSA9IDAuNTtcclxuICAgIGVuZW15LmFuaW1hdGlvbnMuYWRkKCdleHBsb2RlJyk7XHJcblxyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSAgICBmdW5jdGlvbigpe1xyXG5cclxuICAgIGdhbWUucGh5c2ljcy5zdGFydFN5c3RlbShQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xyXG5cclxuICAgIHRoaXMuc3BhY2VCRyA9ICB0aGlzLmFkZC50aWxlU3ByaXRlKDAsIDAsIDgwMCwgNjAwLCAnYmcnKTsgIFxyXG4gICAgdGhpcy5zcGFjZUJHLmF1dG9TY3JvbGwoMCwgNzUpOyBcclxuXHJcblxyXG4gICAgd2luZG93LnBsYXllciA9IHJlcXVpcmUoJy4vcGxheWVyJykoZ2FtZSk7XHJcbiAgICBwbGF5ZXIuaW5pdCgpO1xyXG4gICAgdmFyIGJ1bGxldHMgPSB3aW5kb3cuYnVsbGV0cyA9IHRoaXMuYWRkLmdyb3VwKCk7XHJcblxyXG4gICAgYnVsbGV0cy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuXHJcbiAgICBidWxsZXRzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuXHJcbiAgICBidWxsZXRzLmNyZWF0ZU11bHRpcGxlKDEwLCAnYnVsbGV0cycsICdidWxsZXQtZ3JlZW4ucG5nJyk7XHJcbiAgICBidWxsZXRzLnNldEFsbCgnYW5jaG9yLngnLCAwLjUpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci55JywgMSk7XHJcbiAgICBidWxsZXRzLnNldEFsbCgnb3V0T2ZCb3VuZHNLaWxsJywgdHJ1ZSk7XHJcbiAgICBidWxsZXRzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpO1xyXG5cclxuICAgIFxyXG5cclxuXHJcbiAgICB3aW5kb3cuZXhwbG9zaW9ucyA9IGdhbWUuYWRkLmdyb3VwKCk7XHJcbiAgICBleHBsb3Npb25zLmNyZWF0ZU11bHRpcGxlKDMwLCAnZXhwbG9kZScpO1xyXG4gICAgZXhwbG9zaW9ucy5mb3JFYWNoKHNldHVwRW5lbXksIHRoaXMpO1xyXG4gICAgd2luZG93Lm11c2ljID0gZ2FtZS5hZGQuYXVkaW8oJ3N0YWdlLTEnKTtcclxuICAgIHdpbmRvdy5ib29tID0gZ2FtZS5hZGQuYXVkaW8oJ2Jvb20nKTtcclxuICAgIHdpbmRvdy5sYXplciA9IGdhbWUuYWRkLmF1ZGlvKCdsYXplcicpO1xyXG5cclxuICAgIFxyXG4gICAgd2luZG93LnN0YWdlMSA9IHJlcXVpcmUoJy4vc2NlbmVzL3NjZW5lLTEnKShnYW1lKTtcclxuICAgIHN0YWdlMS5pbml0KCk7XHJcbn1cclxuXHJcbiAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChnYW1lKSB7XHJcblx0dmFyIHBsYXllciwgY3Vyc29ycztcclxuXHR2YXIgcmlnaHRfYnVsbGV0VGltZSA9IDAsIGxlZnRfYnVsbGV0VGltZSA9IDA7IFxyXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVCdWxsZXQgKCkgeyBcclxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gcmlnaHRfYnVsbGV0VGltZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJpZ2h0X2J1bGxldCA9IGJ1bGxldHMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJpZ2h0X2J1bGxldClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgQW5kIGZpcmUgaXRcclxuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQucmVzZXQocGxheWVyLngsIHBsYXllci55ICsgMTYpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0X2J1bGxldC5ib2R5LnZlbG9jaXR5LnkgPSAtMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0X2J1bGxldFRpbWUgPSBnYW1lLnRpbWUubm93ICsgMTAwMDtcclxuICAgICAgICAgICAgICAgICAgICBsYXplci5wbGF5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gbGVmdF9idWxsZXRUaW1lICsgMjApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHZhciBsZWZ0X2J1bGxldCA9IGJ1bGxldHMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlZnRfYnVsbGV0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRfYnVsbGV0LnJlc2V0KHBsYXllci54ICsgMjYsIHBsYXllci55ICsgMTYpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRfYnVsbGV0LmJvZHkudmVsb2NpdHkueSA9IC0zMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdF9idWxsZXRUaW1lID0gZ2FtZS50aW1lLm5vdyArIDEwMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF6ZXIucGxheSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdCA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cGxheWVyID0gZ2FtZS5hZGQuc3ByaXRlKCg0MDAgLSAxNiksIDUwMCwgJ3NoaXAnKTtcclxuICAgIFx0XHRnYW1lLnBoeXNpY3MuZW5hYmxlKHBsYXllciwgUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcclxuICAgIFx0XHRjdXJzb3JzID0gIGdhbWUuaW5wdXQua2V5Ym9hcmQuY3JlYXRlQ3Vyc29yS2V5cygpO1xyXG5cdFx0fSxcclxuXHRcdHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vICBGb3IgZXhhbXBsZSB0aGlzIGNoZWNrcyBpZiB0aGUgdXAgb3IgZG93biBrZXlzIGFyZSBwcmVzc2VkIGFuZCBtb3ZlcyB0aGUgY2FtZXJhIGFjY29yZGluZ2x5LlxyXG5cdCAgICAgICAgaWYgKGN1cnNvcnMudXAuaXNEb3duKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgIC8vICBJZiB0aGUgc2hpZnQga2V5IGlzIGFsc28gcHJlc3NlZCB0aGVuIHRoZSB3b3JsZCBpcyByb3RhdGVkXHJcblx0ICAgICAgICAgICAgaWYgKGN1cnNvcnMudXAuc2hpZnRLZXkpXHJcblx0ICAgICAgICAgICAge1xyXG5cdCAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gKz0gMC4wNTtcclxuXHQgICAgICAgICAgICB9XHJcblx0ICAgICAgICAgICAgZWxzZVxyXG5cdCAgICAgICAgICAgIHtcclxuXHQgICAgICAgICAgICAgICAgaWYocGxheWVyLnkgPiAzNTApIHBsYXllci55IC09IDQ7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgZWxzZSBpZiAoY3Vyc29ycy5kb3duLmlzRG93bilcclxuXHQgICAgICAgIHtcclxuXHQgICAgICAgICAgICBpZiAoY3Vyc29ycy5kb3duLnNoaWZ0S2V5KVxyXG5cdCAgICAgICAgICAgIHtcclxuXHQgICAgICAgICAgICAgICAgLy9nYW1lLndvcmxkLnJvdGF0aW9uIC09IDAuMDU7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgICAgIGVsc2VcclxuXHQgICAgICAgICAgICB7XHJcblx0ICAgICAgICAgICAgICAgIHBsYXllci55ICs9IDQ7XHJcblx0ICAgICAgICAgICAgfVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICAgICAgaWYgKGN1cnNvcnMubGVmdC5pc0Rvd24pXHJcblx0ICAgICAgICB7XHJcblx0ICAgICAgICAgICAgcGxheWVyLnggLT0gNDtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGVsc2UgaWYgKGN1cnNvcnMucmlnaHQuaXNEb3duKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgcGxheWVyLnggKz0gNDtcclxuXHQgICAgICAgIH1cclxuXHQgICAgICAgIGlmIChnYW1lLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuU1BBQ0VCQVIpKVxyXG5cdCAgICAgICAge1xyXG5cdCAgICAgICAgICAgIGZpcmVCdWxsZXQoKSA7XHJcblx0ICAgICAgICB9XHJcblx0XHR9XHJcblx0fVxyXG59IiwibW9kdWxlLmV4cG9ydHMgPSAgZnVuY3Rpb24gKCkge1xyXG4gXHJcbiAgICB0aGlzLmxvYWQuYXRsYXMoJ2J1bGxldHMnLCAnaW1nL2Fzc2V0cy9idWxsZXRzLnBuZycsICdpbWcvYXNzZXRzL2J1bGxldHMuanNvbicpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdibHVlX2J1bGxldCcsICdpbWcvYXNzZXRzL2JsdWUtYnVsbGV0LnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdiZycsICdpbWcvYmFja2dyb3VuZHMvYmcucG5nJyk7IFxyXG4gICAgdGhpcy5sb2FkLmF0bGFzKCdhdGxhcycsICdpbWcvZW5lbXktZmlnaHRlcnMvZW5lbXktZmlnaHRlcnMucG5nJywgJ2ltZy9lbmVteS1maWdodGVycy9lbmVteS1maWdodGVycy5qc29uJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3NoaXAnLCAnaW1nL3NwYWNlX3NoaXBfYmFzZS5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZXhwbG9kZScsICdpbWcvYXNzZXRzL2V4cGxvZGUucG5nJywgMTI4LCAxMjgpO1xyXG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdib29tJywgWydhdWRpby9lZmZlY3RzL2V4cGxvZGUud2F2J10pO1xyXG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdsYXplcicsIFsnYXVkaW8vZWZmZWN0cy9sYXplci53YXYnXSk7XHJcbiAgICB0aGlzLmxvYWQuYXVkaW8oJ3N0YWdlLTEnLCBbJ2F1ZGlvL2JhY2tncm91bmQvc3RhZ2UtMS5tcDMnLCAnYXVkaW8vYmFja2dyb3VuZC9zdGFnZS0xLm9nZyddKTtcclxuXHJcbn0iLCJtb2R1bGUuZXhwb3J0cyA9ICBmdW5jdGlvbiAoZ2FtZSkge1xyXG5cdHZhciByYXB0b3JzO1xyXG4gICAgdmFyIHNwYXduID0gZnVuY3Rpb24gKCkgeyBcclxuXHJcbiAgICAgICAgdmFyIHggPSBnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSg0MCwgNjAwKSAgLCB5ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgMTApO1xyXG4gICAgICAgIHZhciBfYWxpZW4gPSBhbGllbnMuY3JlYXRlKHgsIHksICdhdGxhcycsICdiYWQtZ3V5MS5wbmcnKTtcclxuICAgICAgICBfYWxpZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcclxuIFxyXG4gICAgICAgIF9hbGllbi5ib2R5Lm1vdmVzID0gdHJ1ZTtcclxuICAgICAgICBfYWxpZW4uYm9keS52ZWxvY2l0eS5zZXRUbygwLCAxMDApIDsgXHJcbiAgICB9O1xyXG5cclxuXHR2YXIgY29sbGlzaW9uSGFuZGxlciA9IGZ1bmN0aW9uICAoYnVsbGV0LCBhbGllbikge1xyXG5cclxuXHQgICAgYnVsbGV0LmtpbGwoKTtcclxuXHQgICAgYWxpZW4ua2lsbCgpO1xyXG5cdCAgICB3aW5kb3cuYm9vbS5wbGF5KCk7XHJcblx0ICAgIHZhciB4ID0gYWxpZW4uYm9keS54LCB5ID1hbGllbi5ib2R5LnlcclxuXHQgICAgdmFyIGV4cGxvc2lvbiA9IGV4cGxvc2lvbnMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xyXG5cdCAgICBleHBsb3Npb24ucmVzZXQoYWxpZW4uYm9keS54LCBhbGllbi5ib2R5LnkpO1xyXG5cdCAgICBleHBsb3Npb24ucGxheSgnZXhwbG9kZScsIDMwLCBmYWxzZSwgdHJ1ZSk7XHJcblx0fTtcclxuXHJcbiAgICB2YXIgc3Bhd25SYXB0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBcdHZhciB4ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoNDAsIDYwMCkgICwgeSA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEwKTtcclxuICAgICAgICB2YXIgX2FsaWVuID0gcmFwdG9ycy5jcmVhdGUoeCwgeSwgJ2F0bGFzJywgJ3JhcHRvci0xLnBuZycpO1xyXG4gICAgICAgIF9hbGllbi5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xyXG4gXHJcbiAgICAgICAgX2FsaWVuLmJvZHkubW92ZXMgPSB0cnVlO1xyXG4gICAgICAgIF9hbGllbi5ib2R5LnZlbG9jaXR5LnNldFRvKDAsIDE1MCkgOyBcclxuICAgIH1cclxuXHR2YXIgZW5lbXlGYWN0b3J5O1xyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0aW5pdDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR3aW5kb3cuYWxpZW5zID0gZ2FtZS5hZGQuZ3JvdXAoKTtcclxuICAgIFx0XHRhbGllbnMuZW5hYmxlQm9keSA9IHRydWU7XHJcbiAgICBcdFx0YWxpZW5zLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuICAgIFx0XHRyYXB0b3JzID0gZ2FtZS5hZGQuZ3JvdXAoKTtcclxuICAgIFx0XHRyYXB0b3JzLmVuYWJsZUJvZHkgPSB0cnVlO1xyXG4gICAgXHRcdHJhcHRvcnMucGh5c2ljc0JvZHlUeXBlID0gUGhhc2VyLlBoeXNpY3MuQVJDQURFO1xyXG5cdFx0ICAgIG11c2ljLnBsYXkoJycsIDAsIDEsIHRydWUpO1xyXG5cclxuICAgIFx0XHRnYW1lLnRpbWUuZXZlbnRzLnJlcGVhdChQaGFzZXIuVGltZXIuU0VDT05EICogMiwgMTA1LCBzcGF3biwgdGhpcyk7XHJcblxyXG4gICAgXHRcdGdhbWUudGltZS5ldmVudHMucmVwZWF0KFBoYXNlci5UaW1lci5TRUNPTkQgKiA4LCAyMCwgc3Bhd25SYXB0b3IsIHRoaXMpO1xyXG5cdFx0fSxcclxuXHRcdHVwZGF0ZSA6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0Ly9nYW1lIGxvb3AgZm9yIHRoZSBzdGFnZVxyXG5cdFx0XHRnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAoYnVsbGV0cywgYWxpZW5zLCBjb2xsaXNpb25IYW5kbGVyLCBudWxsLCB0aGlzKTtcclxuXHRcdFx0Z2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKGJ1bGxldHMsIHJhcHRvcnMsIGNvbGxpc2lvbkhhbmRsZXIsIG51bGwsIHRoaXMpO1xyXG5cdFx0fSxcclxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHR9XHJcblx0fVxyXG59IiwidmFyIGJ1bGxldFRpbWUgPSAwO1xyXG4gZnVuY3Rpb24gcmVzZXRCdWxsZXQgKGJ1bGxldCkge1xyXG5cclxuICAgIGJ1bGxldC5raWxsKCk7XHJcblxyXG59O1xyXG5cclxuIFxyXG4gICAgdmFyIHJpZ2h0X2J1bGxldFRpbWUgPSAwLCBsZWZ0X2J1bGxldFRpbWUgPSAwOyBcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBidWxsZXRzID0gd2luZG93LmJ1bGxldHM7XHJcblxyXG4gICAgXHJcbiAgICB2YXIgY3Vyc29ycyA9IHdpbmRvdy5jdXJzb3JzOyBcclxuXHJcblxyXG5cclxuICAgIHBsYXllci51cGRhdGUoKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnNvcnMpO1xyXG4gICAgICAgIHN0YWdlMS51cGRhdGUoKTtcclxuICAgICAgICBcclxufTtcclxuIl19
