(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var globals = {
  bullets: null,
  enemies: null,
  player: null
};
var update = require('./game/update');
var preload = require('./game/preload');
var create = require('./game/create');
var game = window.game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
  preload: preload,
  create: create,
  update: update
});


},{"./game/create":2,"./game/preload":3,"./game/update":4}],2:[function(require,module,exports){
"use strict";
function resetBullet(bullet) {
  bullet.kill();
}
;
function setupEnemy(enemy) {
  enemy.anchor.x = 0.5;
  enemy.anchor.y = 0.5;
  enemy.animations.add('explode');
}
;
module.exports = function() {
  game.physics.startSystem(Phaser.Physics.ARCADE);
  this.spaceBG = this.add.tileSprite(0, 0, 800, 600, 'bg');
  this.spaceBG.autoScroll(0, 75);
  var ef = window.ef = this.add.sprite((400 - 16), 10, 'atlas');
  ef.frameName = "bad-guy1.png";
  console.log(ef);
  game.physics.enable(ef, Phaser.Physics.ARCADE);
  var player = window.player = this.add.sprite((400 - 16), 500, 'ship');
  game.physics.enable(player, Phaser.Physics.ARCADE);
  var cursors = window.cursors = this.input.keyboard.createCursorKeys();
  var bullets = window.bullets = this.add.group();
  bullets.enableBody = true;
  bullets.physicsBodyType = Phaser.Physics.ARCADE;
  bullets.createMultiple(10, 'bullets');
  bullets.setAll('anchor.x', 0.5);
  bullets.setAll('anchor.y', 1);
  bullets.setAll('outOfBoundsKill', true);
  bullets.setAll('checkWorldBounds', true);
  window.aliens = game.add.group();
  aliens.enableBody = true;
  aliens.physicsBodyType = Phaser.Physics.ARCADE;
  window.explosions = game.add.group();
  explosions.createMultiple(30, 'explode');
  explosions.forEach(setupEnemy, this);
  var spawn = function() {
    console.log('spawn');
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(40, 300);
    var _alien = aliens.create(x, y, 'enemy');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = false;
  };
  game.time.events.repeat(Phaser.Timer.SECOND * 2, 25, spawn, this);
};


},{}],3:[function(require,module,exports){
"use strict";
module.exports = function() {
  this.load.image('enemy', 'img/enemy-fighters/bad-guy1-a.png');
  this.load.atlas('bullets', 'img/assets/bullets.png', 'img/assets/bullets.json');
  this.load.image('blue_bullet', 'img/assets/blue-bullet.png');
  this.load.image('bg', 'img/backgrounds/bg.png');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.atlas('atlas', 'img/enemy-fighters/enemy-fighters.png', 'img/enemy-fighters/enemy-fighters.json');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.spritesheet('explode', 'img/assets/explode.png', 128, 128);
};


},{}],4:[function(require,module,exports){
"use strict";
var bulletTime = 0;
function resetBullet(bullet) {
  bullet.kill();
}
;
function collisionHandler(bullet, alien) {
  console.log(arguments);
  bullet.kill();
  alien.kill();
  var x = alien.body.x,
      y = alien.body.y;
  var explosion = explosions.getFirstExists(false);
  explosion.reset(alien.body.x, alien.body.y);
  explosion.play('explode', 30, false, true);
}
;
module.exports = function() {
  var bullets = window.bullets;
  var right_bulletTime = 0,
      left_bulletTime = 0;
  var cursors = window.cursors;
  function fireBullet() {
    if (game.time.now > right_bulletTime) {
      var right_bullet = bullets.getFirstExists(false);
      if (right_bullet) {
        right_bullet.reset(player.x, player.y + 16);
        right_bullet.body.velocity.y = -300;
        right_bulletTime = game.time.now + 200;
      }
    }
    if (game.time.now > left_bulletTime) {
      var left_bullet = bullets.getFirstExists(false);
      if (left_bullet) {
        left_bullet.reset(player.x + 26, player.y + 16);
        left_bullet.body.velocity.y = -300;
        left_bulletTime = game.time.now + 200;
      }
    }
  }
  if (cursors.up.isDown) {
    if (cursors.up.shiftKey) {} else {
      if (player.y > 350)
        player.y -= 4;
    }
  } else if (cursors.down.isDown) {
    if (cursors.down.shiftKey) {} else {
      player.y += 4;
    }
  }
  if (cursors.left.isDown) {
    player.x -= 4;
  } else if (cursors.right.isDown) {
    player.x += 4;
  }
  if (this.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {
    fireBullet();
  }
  game.physics.arcade.overlap(bullets, ef, collisionHandler, null, this);
  game.physics.arcade.overlap(bullets, aliens, collisionHandler, null, this);
};


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZS5qcyIsIkM6XFxVc2Vyc1xcS2V2aW5cXFByb2plY3RzXFxzcGFjZS1kZWZlbnNlXFxwdWJsaWNcXGpzXFxnYW1lXFxjcmVhdGUuanMiLCJDOlxcVXNlcnNcXEtldmluXFxQcm9qZWN0c1xcc3BhY2UtZGVmZW5zZVxccHVibGljXFxqc1xcZ2FtZVxccHJlbG9hZC5qcyIsIkM6XFxVc2Vyc1xcS2V2aW5cXFByb2plY3RzXFxzcGFjZS1kZWZlbnNlXFxwdWJsaWNcXGpzXFxnYW1lXFx1cGRhdGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUFJLENBQUosRUFBSSxDQUFBLE9BQU8sRUFBRztBQUNWLENBQUEsUUFBTyxDQUFFLEtBQUk7QUFDYixDQUFBLFFBQU8sQ0FBRSxLQUFJO0FBQ2IsQ0FBQSxPQUFNLENBQUUsS0FBSTtDQUFBLEFBQ2YsQ0FBQTtBQUNHLENBQUosRUFBSSxDQUFBLE1BQU0sRUFBRyxDQUFBLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUNsQyxDQUFKLEVBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBRTtBQUNyQyxDQUFKLEVBQUksQ0FBQSxNQUFNLEVBQUcsQ0FBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFFbEMsQ0FBSixFQUFJLENBQUEsSUFBSSxFQUFHLENBQUEsTUFBTSxLQUFLLEVBQUcsSUFBSSxDQUFBLE1BQU0sS0FBSyxDQUFDLEdBQUcsQ0FBRSxJQUFHLENBQUUsQ0FBQSxNQUFNLEtBQUssQ0FBRSxHQUFF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LENBQUEsSUFBSSxLQUFLLElBQUksRUFBRyxJQUFHLENBQUM7T0FDekM7Q0FBQSxJQUNKO0NBQUEsRUFDSjtBQUdELENBSEMsS0FHRyxPQUFPLEdBQUcsT0FBTyxDQUNyQjtDQUVJLE9BQUksT0FBTyxHQUFHLFNBQVMsQ0FDdkIsR0FFQyxLQUVEO0NBQ0ksU0FBRyxNQUFNLEVBQUUsRUFBRyxJQUFHO0FBQUUsQ0FBQSxhQUFNLEVBQUUsR0FBSSxFQUFDLENBQUM7Q0FBQSxJQUNwQztDQUFBLEVBQ0osS0FDSSxLQUFJLE9BQU8sS0FBSyxPQUFPLENBQzVCO0NBQ0ksT0FBSSxPQUFPLEtBQUssU0FBUyxDQUN6QixHQUVDLEtBRUQ7QUFDSSxDQUFBLFdBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztLQUNqQjtDQUFBLEVBQ0o7QUFDRCxDQURDLEtBQ0csT0FBTyxLQUFLLE9BQU8sQ0FDdkI7QUFDSSxDQUFBLFNBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztHQUNqQixLQUNJLEtBQUksT0FBTyxNQUFNLE9BQU8sQ0FDN0I7QUFDRyxDQUFBLFNBQU0sRUFBRSxHQUFJLEVBQUMsQ0FBQztHQUNoQjtBQUNELENBREMsS0FDRyxJQUFJLE1BQU0sU0FBUyxPQUFPLENBQUMsTUFBTSxTQUFTLFNBQVMsQ0FBQyxDQUN4RDtBQUNJLENBQUEsYUFBVSxFQUFFLENBQUU7R0FDakI7QUFFQSxDQUZBLEtBRUksUUFBUSxPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUUsR0FBRSxDQUFFLGlCQUFnQixDQUFFLEtBQUksQ0FBRSxLQUFJLENBQUMsQ0FBQztBQUN2RSxDQUFBLEtBQUksUUFBUSxPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUUsT0FBTSxDQUFFLGlCQUFnQixDQUFFLEtBQUksQ0FBRSxLQUFJLENBQUMsQ0FBQztDQUNuRixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBnbG9iYWxzID0ge1xyXG4gICAgYnVsbGV0czogbnVsbCxcclxuICAgIGVuZW1pZXM6IG51bGwsXHJcbiAgICBwbGF5ZXI6IG51bGxcclxufVxyXG52YXIgdXBkYXRlID0gcmVxdWlyZSgnLi9nYW1lL3VwZGF0ZScpO1xyXG52YXIgcHJlbG9hZCA9IHJlcXVpcmUoJy4vZ2FtZS9wcmVsb2FkJykgO1xyXG52YXIgY3JlYXRlID0gcmVxdWlyZSgnLi9nYW1lL2NyZWF0ZScpO1xyXG4gXHJcbnZhciBnYW1lID0gd2luZG93LmdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoODAwLCA2MDAsIFBoYXNlci5BVVRPLCAnJywgeyBwcmVsb2FkOiBwcmVsb2FkLCBjcmVhdGU6IGNyZWF0ZSwgdXBkYXRlOiB1cGRhdGUgfSk7XHJcbiIsIiBmdW5jdGlvbiByZXNldEJ1bGxldCAoYnVsbGV0KSB7XHJcblxyXG4gICAgYnVsbGV0LmtpbGwoKTtcclxuXHJcbn1cclxuO1xyXG5mdW5jdGlvbiBzZXR1cEVuZW15IChlbmVteSkge1xyXG5cclxuICAgIGVuZW15LmFuY2hvci54ID0gMC41O1xyXG4gICAgZW5lbXkuYW5jaG9yLnkgPSAwLjU7XHJcbiAgICBlbmVteS5hbmltYXRpb25zLmFkZCgnZXhwbG9kZScpO1xyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gICAgZnVuY3Rpb24oKXtcclxuXHJcbiAgICBnYW1lLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcclxuXHJcbiAgICB0aGlzLnNwYWNlQkcgPSAgdGhpcy5hZGQudGlsZVNwcml0ZSgwLCAwLCA4MDAsIDYwMCwgJ2JnJyk7ICBcclxuICAgIHRoaXMuc3BhY2VCRy5hdXRvU2Nyb2xsKDAsIDc1KTsgXHJcblxyXG4gICAgdmFyIGVmID0gd2luZG93LmVmID0gdGhpcy5hZGQuc3ByaXRlKCg0MDAgLSAxNiksIDEwLCAnYXRsYXMnKTtcclxuICAgIGVmLmZyYW1lTmFtZSA9IFwiYmFkLWd1eTEucG5nXCI7XHJcbiAgICBjb25zb2xlLmxvZyhlZik7XHJcbiAgICBnYW1lLnBoeXNpY3MuZW5hYmxlKGVmLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xyXG4gICAgdmFyIHBsYXllciA9IHdpbmRvdy5wbGF5ZXIgPSB0aGlzLmFkZC5zcHJpdGUoKDQwMCAtIDE2KSwgNTAwLCAnc2hpcCcpO1xyXG4gICAgZ2FtZS5waHlzaWNzLmVuYWJsZShwbGF5ZXIsIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcbiAgICB2YXIgY3Vyc29ycyA9IHdpbmRvdy5jdXJzb3JzID0gdGhpcy5pbnB1dC5rZXlib2FyZC5jcmVhdGVDdXJzb3JLZXlzKCk7XHJcblxyXG4gICAgdmFyIGJ1bGxldHMgPSB3aW5kb3cuYnVsbGV0cyA9IHRoaXMuYWRkLmdyb3VwKCk7XHJcblxyXG4gICAgYnVsbGV0cy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuXHJcbiAgICBidWxsZXRzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcclxuXHJcbiAgICBidWxsZXRzLmNyZWF0ZU11bHRpcGxlKDEwLCAnYnVsbGV0cycpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcclxuICAgIGJ1bGxldHMuc2V0QWxsKCdhbmNob3IueScsIDEpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ291dE9mQm91bmRzS2lsbCcsIHRydWUpO1xyXG4gICAgYnVsbGV0cy5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcclxuXHJcbiAgICB3aW5kb3cuYWxpZW5zID0gZ2FtZS5hZGQuZ3JvdXAoKTtcclxuICAgIGFsaWVucy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuICAgIGFsaWVucy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcblxyXG4gICAgd2luZG93LmV4cGxvc2lvbnMgPSBnYW1lLmFkZC5ncm91cCgpO1xyXG4gICAgZXhwbG9zaW9ucy5jcmVhdGVNdWx0aXBsZSgzMCwgJ2V4cGxvZGUnKTtcclxuICAgIGV4cGxvc2lvbnMuZm9yRWFjaChzZXR1cEVuZW15LCB0aGlzKTtcclxuXHJcbiAgICB2YXIgc3Bhd24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnc3Bhd24nKTtcclxuICAgIHZhciB4ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoNDAsIDYwMCkgICwgeSA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDQwLCAzMDApO1xyXG4gICAgICAgICAgICB2YXIgX2FsaWVuID0gYWxpZW5zLmNyZWF0ZSh4LCB5LCAnZW5lbXknKTtcclxuICAgICAgICAgICAgX2FsaWVuLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiBcclxuICAgICAgICAgICAgX2FsaWVuLmJvZHkubW92ZXMgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgICBnYW1lLnRpbWUuZXZlbnRzLnJlcGVhdChQaGFzZXIuVGltZXIuU0VDT05EICogMiwgMjUsIHNwYXduLCB0aGlzKTtcclxufVxyXG5cclxuICIsIm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcclxuIFxyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdlbmVteScsICdpbWcvZW5lbXktZmlnaHRlcnMvYmFkLWd1eTEtYS5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5hdGxhcygnYnVsbGV0cycsICdpbWcvYXNzZXRzL2J1bGxldHMucG5nJywgJ2ltZy9hc3NldHMvYnVsbGV0cy5qc29uJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JsdWVfYnVsbGV0JywgJ2ltZy9hc3NldHMvYmx1ZS1idWxsZXQucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JnJywgJ2ltZy9iYWNrZ3JvdW5kcy9iZy5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hpcCcsICdpbWcvc3BhY2Vfc2hpcF9iYXNlLnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmF0bGFzKCdhdGxhcycsICdpbWcvZW5lbXktZmlnaHRlcnMvZW5lbXktZmlnaHRlcnMucG5nJywgJ2ltZy9lbmVteS1maWdodGVycy9lbmVteS1maWdodGVycy5qc29uJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3NoaXAnLCAnaW1nL3NwYWNlX3NoaXBfYmFzZS5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZXhwbG9kZScsICdpbWcvYXNzZXRzL2V4cGxvZGUucG5nJywgMTI4LCAxMjgpO1xyXG5cclxufSIsInZhciBidWxsZXRUaW1lID0gMDtcclxuIGZ1bmN0aW9uIHJlc2V0QnVsbGV0IChidWxsZXQpIHtcclxuXHJcbiAgICBidWxsZXQua2lsbCgpO1xyXG5cclxufTtcclxuXHJcbmZ1bmN0aW9uIGNvbGxpc2lvbkhhbmRsZXIgKGJ1bGxldCwgYWxpZW4pIHtcclxuY29uc29sZS5sb2coYXJndW1lbnRzKTtcclxuICAgIC8vICBXaGVuIGEgYnVsbGV0IGhpdHMgYW4gYWxpZW4gd2Uga2lsbCB0aGVtIGJvdGhcclxuICAgIGJ1bGxldC5raWxsKCk7XHJcbiAgICBhbGllbi5raWxsKCk7XHJcbnZhciB4ID0gYWxpZW4uYm9keS54LCB5ID1hbGllbi5ib2R5LnlcclxuICAgIHZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgIGV4cGxvc2lvbi5yZXNldChhbGllbi5ib2R5LngsIGFsaWVuLmJvZHkueSk7XHJcbiAgICBleHBsb3Npb24ucGxheSgnZXhwbG9kZScsIDMwLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAvLyAgSW5jcmVhc2UgdGhlIHNjb3JlXHJcbiAgIC8vIHNjb3JlICs9IDIwO1xyXG4gICAgLy9zY29yZVRleHQudGV4dCA9IHNjb3JlU3RyaW5nICsgc2NvcmU7XHJcblxyXG4gICAgLy8gIEFuZCBjcmVhdGUgYW4gZXhwbG9zaW9uIDopXHJcbiAgICAvL3ZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgIC8vZXhwbG9zaW9uLnJlc2V0KGFsaWVuLmJvZHkueCwgYWxpZW4uYm9keS55KTtcclxuICAgIC8vZXhwbG9zaW9uLnBsYXkoJ2thYm9vbScsIDMwLCBmYWxzZSwgdHJ1ZSk7XHJcblxyXG4gICAgLy9pZiAoYWxpZW5zLmNvdW50TGl2aW5nKCkgPT0gMClcclxuICAgIC8ve1xyXG4gICAgICAgLy8gc2NvcmUgKz0gMTAwMDtcclxuICAgICAgLy8gIHNjb3JlVGV4dC50ZXh0ID0gc2NvcmVTdHJpbmcgKyBzY29yZTtcclxuXHJcbiAgICAgICAvLyBlbmVteUJ1bGxldHMuY2FsbEFsbCgna2lsbCcsdGhpcyk7XHJcbiAgICAgICAvLyBzdGF0ZVRleHQudGV4dCA9IFwiIFlvdSBXb24sIFxcbiBDbGljayB0byByZXN0YXJ0XCI7XHJcbiAgICAgICAvLyBzdGF0ZVRleHQudmlzaWJsZSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vdGhlIFwiY2xpY2sgdG8gcmVzdGFydFwiIGhhbmRsZXJcclxuICAgICAgLy8gIGdhbWUuaW5wdXQub25UYXAuYWRkT25jZShyZXN0YXJ0LHRoaXMpO1xyXG4gICAgLy99XHJcblxyXG4gICAgLy9nYW1lLmFkZC5zcHJpdGUoKDQwMCAtIDE2KSwgMTAsICdhdGxhcycpO1xyXG4gICAgLy9lZi5mcmFtZU5hbWUgPSBcImJhZC1ndXkxLnBuZ1wiO1xyXG59O1xyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBidWxsZXRzID0gd2luZG93LmJ1bGxldHM7XHJcbiAgICB2YXIgcmlnaHRfYnVsbGV0VGltZSA9IDAsIGxlZnRfYnVsbGV0VGltZSA9IDA7IFxyXG4gICAgXHJcbiAgICB2YXIgY3Vyc29ycyA9IHdpbmRvdy5jdXJzb3JzOyBcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZmlyZUJ1bGxldCAoKSB7IFxyXG4gICAgICAgICAgICBpZiAoIGdhbWUudGltZS5ub3cgPiByaWdodF9idWxsZXRUaW1lKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmlnaHRfYnVsbGV0ID0gYnVsbGV0cy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmlnaHRfYnVsbGV0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0X2J1bGxldC5yZXNldChwbGF5ZXIueCwgcGxheWVyLnkgKyAxNik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0LmJvZHkudmVsb2NpdHkueSA9IC0zMDA7XHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0VGltZSA9IGdhbWUudGltZS5ub3cgKyAyMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gbGVmdF9idWxsZXRUaW1lKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVmdF9idWxsZXQgPSBidWxsZXRzLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICAgICAgICAgIGlmIChsZWZ0X2J1bGxldClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgQW5kIGZpcmUgaXRcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5yZXNldChwbGF5ZXIueCArIDI2LCBwbGF5ZXIueSArIDE2KTtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5ib2R5LnZlbG9jaXR5LnkgPSAtMzAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGxlZnRfYnVsbGV0VGltZSA9IGdhbWUudGltZS5ub3cgKyAyMDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vICBGb3IgZXhhbXBsZSB0aGlzIGNoZWNrcyBpZiB0aGUgdXAgb3IgZG93biBrZXlzIGFyZSBwcmVzc2VkIGFuZCBtb3ZlcyB0aGUgY2FtZXJhIGFjY29yZGluZ2x5LlxyXG4gICAgICAgIGlmIChjdXJzb3JzLnVwLmlzRG93bilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vICBJZiB0aGUgc2hpZnQga2V5IGlzIGFsc28gcHJlc3NlZCB0aGVuIHRoZSB3b3JsZCBpcyByb3RhdGVkXHJcbiAgICAgICAgICAgIGlmIChjdXJzb3JzLnVwLnNoaWZ0S2V5KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gKz0gMC4wNTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHBsYXllci55ID4gMzUwKSBwbGF5ZXIueSAtPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGN1cnNvcnMuZG93bi5pc0Rvd24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAoY3Vyc29ycy5kb3duLnNoaWZ0S2V5KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gLT0gMC4wNTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBsYXllci55ICs9IDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnNvcnMubGVmdC5pc0Rvd24pXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwbGF5ZXIueCAtPSA0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjdXJzb3JzLnJpZ2h0LmlzRG93bilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgcGxheWVyLnggKz0gNDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaW5wdXQua2V5Ym9hcmQuaXNEb3duKFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUikpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmaXJlQnVsbGV0KCkgO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnNvcnMpO1xyXG4gICAgICAgICBnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAoYnVsbGV0cywgZWYsIGNvbGxpc2lvbkhhbmRsZXIsIG51bGwsIHRoaXMpO1xyXG4gICAgICAgICBnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAoYnVsbGV0cywgYWxpZW5zLCBjb2xsaXNpb25IYW5kbGVyLCBudWxsLCB0aGlzKTtcclxufTtcclxuIl19
