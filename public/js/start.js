(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var globals = {
  bullets: null,
  enemies: null,
  player: null
};
var update = require('./game/update');
var preload = require('./game/preload');
var create = require('./game/create');
var game = window.game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
  preload: preload,
  create: create,
  update: update
});


},{"./game/create":2,"./game/preload":3,"./game/update":4}],2:[function(require,module,exports){
"use strict";
function resetBullet(bullet) {
  bullet.kill();
}
;
module.exports = function() {
  console.log(this);
  game.physics.startSystem(Phaser.Physics.ARCADE);
  this.spaceBG = this.add.tileSprite(0, 0, 800, 600, 'bg');
  this.spaceBG.autoScroll(0, 75);
  var ef = window.ef = this.add.sprite((400 - 16), 10, 'atlas');
  ef.frameName = "bad-guy1.png";
  console.log(ef);
  game.physics.enable(ef, Phaser.Physics.ARCADE);
  var player = window.player = this.add.sprite((400 - 16), 500, 'ship');
  game.physics.enable(player, Phaser.Physics.ARCADE);
  var cursors = window.cursors = this.input.keyboard.createCursorKeys();
  var bullets = window.bullets = this.add.group();
  bullets.enableBody = true;
  bullets.physicsBodyType = Phaser.Physics.ARCADE;
  bullets.createMultiple(10, 'bullets');
  bullets.setAll('anchor.x', 0.5);
  bullets.setAll('anchor.y', 1);
  bullets.setAll('outOfBoundsKill', true);
  bullets.setAll('checkWorldBounds', true);
};


},{}],3:[function(require,module,exports){
"use strict";
module.exports = function() {
  this.load.atlas('bullets', 'img/assets/bullets.png', 'img/assets/bullets.json');
  this.load.image('blue_bullet', 'img/assets/blue-bullet.png');
  this.load.image('bg', 'img/backgrounds/bg.png');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.atlas('atlas', 'img/enemy-fighters/enemy-fighters.png', 'img/enemy-fighters/enemy-fighters.json');
  this.load.image('ship', 'img/space_ship_base.png');
};


},{}],4:[function(require,module,exports){
"use strict";
var bulletTime = 0;
function resetBullet(bullet) {
  bullet.kill();
}
;
function collisionHandler(bullet, alien) {
  console.log(arguments);
  bullet.kill();
  alien.kill();
}
;
module.exports = function() {
  var bullets = window.bullets;
  var right_bulletTime = 0,
      left_bulletTime = 0;
  var game = window.game;
  var cursors = window.cursors;
  function fireBullet() {
    if (game.time.now > right_bulletTime) {
      var right_bullet = bullets.getFirstExists(false);
      if (right_bullet) {
        right_bullet.reset(player.x, player.y + 16);
        right_bullet.body.velocity.y = -300;
        right_bulletTime = game.time.now + 200;
      }
    }
    if (game.time.now > left_bulletTime) {
      var left_bullet = bullets.getFirstExists(false);
      if (left_bullet) {
        left_bullet.reset(player.x + 26, player.y + 16);
        left_bullet.body.velocity.y = -300;
        left_bulletTime = game.time.now + 200;
      }
    }
  }
  if (cursors.up.isDown) {
    if (cursors.up.shiftKey) {} else {
      if (player.y > 350)
        player.y -= 4;
    }
  } else if (cursors.down.isDown) {
    if (cursors.down.shiftKey) {} else {
      player.y += 4;
    }
  }
  if (cursors.left.isDown) {
    player.x -= 4;
  } else if (cursors.right.isDown) {
    player.x += 4;
  }
  if (this.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {
    fireBullet();
  }
  game.physics.arcade.overlap(bullets, ef, collisionHandler, null, this);
};


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2Uvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS9jcmVhdGUuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvcHJlbG9hZC5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS91cGRhdGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUFJLENBQUosRUFBSSxDQUFBLE9BQU8sRUFBRztBQUNWLENBQUEsUUFBTyxDQUFFLEtBQUk7QUFDYixDQUFBLFFBQU8sQ0FBRSxLQUFJO0FBQ2IsQ0FBQSxPQUFNLENBQUUsS0FBSTtDQUFBLEFBQ2YsQ0FBQTtBQUNHLENBQUosRUFBSSxDQUFBLE1BQU0sRUFBRyxDQUFBLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztBQUNsQyxDQUFKLEVBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBRTtBQUNyQyxDQUFKLEVBQUksQ0FBQSxNQUFNLEVBQUcsQ0FBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFFbEMsQ0FBSixFQUFJLENBQUEsSUFBSSxFQUFHLENBQUEsTUFBTSxLQUFLLEVBQUcsSUFBSSxDQUFBLE1BQU0sS0FBSyxDQUFDLEdBQUcsQ0FBRSxJQUFHLENBQUUsQ0FBQSxNQUFNLEtBQUssQ0FBRSxHQUFFLENBQUU7QUFBRSxDQUFBLFFBQU8sQ0FBRSxRQUFP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Q0FBQztHQUNoQjtBQUNELENBREMsS0FDRyxJQUFJLE1BQU0sU0FBUyxPQUFPLENBQUMsTUFBTSxTQUFTLFNBQVMsQ0FBQyxDQUN4RDtBQUNJLENBQUEsYUFBVSxFQUFFLENBQUU7R0FDakI7QUFFQSxDQUZBLEtBRUksUUFBUSxPQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUUsR0FBRSxDQUFFLGlCQUFnQixDQUFFLEtBQUksQ0FBRSxLQUFJLENBQUMsQ0FBQztDQUMvRSxDQUFBO0NBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBnbG9iYWxzID0ge1xuICAgIGJ1bGxldHM6IG51bGwsXG4gICAgZW5lbWllczogbnVsbCxcbiAgICBwbGF5ZXI6IG51bGxcbn1cbnZhciB1cGRhdGUgPSByZXF1aXJlKCcuL2dhbWUvdXBkYXRlJyk7XG52YXIgcHJlbG9hZCA9IHJlcXVpcmUoJy4vZ2FtZS9wcmVsb2FkJykgO1xudmFyIGNyZWF0ZSA9IHJlcXVpcmUoJy4vZ2FtZS9jcmVhdGUnKTtcbiBcbnZhciBnYW1lID0gd2luZG93LmdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoODAwLCA2MDAsIFBoYXNlci5BVVRPLCAnJywgeyBwcmVsb2FkOiBwcmVsb2FkLCBjcmVhdGU6IGNyZWF0ZSwgdXBkYXRlOiB1cGRhdGUgfSk7XG4iLCIgZnVuY3Rpb24gcmVzZXRCdWxsZXQgKGJ1bGxldCkge1xuXG4gICAgYnVsbGV0LmtpbGwoKTtcblxufVxuO1xubW9kdWxlLmV4cG9ydHMgPSAgICBmdW5jdGlvbigpe1xuICAgIGNvbnNvbGUubG9nKHRoaXMpO1xuZ2FtZS5waHlzaWNzLnN0YXJ0U3lzdGVtKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG5cbiAgICB0aGlzLnNwYWNlQkcgPSAgdGhpcy5hZGQudGlsZVNwcml0ZSgwLCAwLCA4MDAsIDYwMCwgJ2JnJyk7ICBcbiAgICB0aGlzLnNwYWNlQkcuYXV0b1Njcm9sbCgwLCA3NSk7IFxuXG4gICAgdmFyIGVmID0gd2luZG93LmVmID0gdGhpcy5hZGQuc3ByaXRlKCg0MDAgLSAxNiksIDEwLCAnYXRsYXMnKTtcbiAgICBlZi5mcmFtZU5hbWUgPSBcImJhZC1ndXkxLnBuZ1wiO1xuICAgIGNvbnNvbGUubG9nKGVmKTtcbiAgICBnYW1lLnBoeXNpY3MuZW5hYmxlKGVmLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuICAgIHZhciBwbGF5ZXIgPSB3aW5kb3cucGxheWVyID0gdGhpcy5hZGQuc3ByaXRlKCg0MDAgLSAxNiksIDUwMCwgJ3NoaXAnKTtcbiAgICBnYW1lLnBoeXNpY3MuZW5hYmxlKHBsYXllciwgUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcbiAgICB2YXIgY3Vyc29ycyA9IHdpbmRvdy5jdXJzb3JzID0gdGhpcy5pbnB1dC5rZXlib2FyZC5jcmVhdGVDdXJzb3JLZXlzKCk7XG5cbiAgICB2YXIgYnVsbGV0cyA9IHdpbmRvdy5idWxsZXRzID0gdGhpcy5hZGQuZ3JvdXAoKTtcblxuICAgIGJ1bGxldHMuZW5hYmxlQm9keSA9IHRydWU7XG5cbiAgICBidWxsZXRzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcblxuICAgIGJ1bGxldHMuY3JlYXRlTXVsdGlwbGUoMTAsICdidWxsZXRzJyk7XG4gICAgYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcbiAgICBidWxsZXRzLnNldEFsbCgnYW5jaG9yLnknLCAxKTtcbiAgICBidWxsZXRzLnNldEFsbCgnb3V0T2ZCb3VuZHNLaWxsJywgdHJ1ZSk7XG4gICAgYnVsbGV0cy5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcbn1cblxuICIsIm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcbiBcbiAgICAvL3RoaXMubG9hZC5pbWFnZSgnZW5lbXlGaWdodGVyJywgJ2ltZy9lbmVteS1maWdodGVycy9iYWQtZ3V5MS1hLnBuZycpO1xuICAgIHRoaXMubG9hZC5hdGxhcygnYnVsbGV0cycsICdpbWcvYXNzZXRzL2J1bGxldHMucG5nJywgJ2ltZy9hc3NldHMvYnVsbGV0cy5qc29uJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdibHVlX2J1bGxldCcsICdpbWcvYXNzZXRzL2JsdWUtYnVsbGV0LnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnYmcnLCAnaW1nL2JhY2tncm91bmRzL2JnLnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hpcCcsICdpbWcvc3BhY2Vfc2hpcF9iYXNlLnBuZycpO1xuICAgIHRoaXMubG9hZC5hdGxhcygnYXRsYXMnLCAnaW1nL2VuZW15LWZpZ2h0ZXJzL2VuZW15LWZpZ2h0ZXJzLnBuZycsICdpbWcvZW5lbXktZmlnaHRlcnMvZW5lbXktZmlnaHRlcnMuanNvbicpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hpcCcsICdpbWcvc3BhY2Vfc2hpcF9iYXNlLnBuZycpO1xuXG59IiwidmFyIGJ1bGxldFRpbWUgPSAwO1xuIGZ1bmN0aW9uIHJlc2V0QnVsbGV0IChidWxsZXQpIHtcblxuICAgIGJ1bGxldC5raWxsKCk7XG5cbn07XG5cbmZ1bmN0aW9uIGNvbGxpc2lvbkhhbmRsZXIgKGJ1bGxldCwgYWxpZW4pIHtcbmNvbnNvbGUubG9nKGFyZ3VtZW50cyk7XG4gICAgLy8gIFdoZW4gYSBidWxsZXQgaGl0cyBhbiBhbGllbiB3ZSBraWxsIHRoZW0gYm90aFxuICAgIGJ1bGxldC5raWxsKCk7XG4gICAgYWxpZW4ua2lsbCgpO1xuXG4gICAgLy8gIEluY3JlYXNlIHRoZSBzY29yZVxuICAgLy8gc2NvcmUgKz0gMjA7XG4gICAgLy9zY29yZVRleHQudGV4dCA9IHNjb3JlU3RyaW5nICsgc2NvcmU7XG5cbiAgICAvLyAgQW5kIGNyZWF0ZSBhbiBleHBsb3Npb24gOilcbiAgICAvL3ZhciBleHBsb3Npb24gPSBleHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcbiAgICAvL2V4cGxvc2lvbi5yZXNldChhbGllbi5ib2R5LngsIGFsaWVuLmJvZHkueSk7XG4gICAgLy9leHBsb3Npb24ucGxheSgna2Fib29tJywgMzAsIGZhbHNlLCB0cnVlKTtcblxuICAgIC8vaWYgKGFsaWVucy5jb3VudExpdmluZygpID09IDApXG4gICAgLy97XG4gICAgICAgLy8gc2NvcmUgKz0gMTAwMDtcbiAgICAgIC8vICBzY29yZVRleHQudGV4dCA9IHNjb3JlU3RyaW5nICsgc2NvcmU7XG5cbiAgICAgICAvLyBlbmVteUJ1bGxldHMuY2FsbEFsbCgna2lsbCcsdGhpcyk7XG4gICAgICAgLy8gc3RhdGVUZXh0LnRleHQgPSBcIiBZb3UgV29uLCBcXG4gQ2xpY2sgdG8gcmVzdGFydFwiO1xuICAgICAgIC8vIHN0YXRlVGV4dC52aXNpYmxlID0gdHJ1ZTtcblxuICAgICAgICAvL3RoZSBcImNsaWNrIHRvIHJlc3RhcnRcIiBoYW5kbGVyXG4gICAgICAvLyAgZ2FtZS5pbnB1dC5vblRhcC5hZGRPbmNlKHJlc3RhcnQsdGhpcyk7XG4gICAgLy99XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9ICBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJ1bGxldHMgPSB3aW5kb3cuYnVsbGV0cztcbiAgICB2YXIgcmlnaHRfYnVsbGV0VGltZSA9IDAsIGxlZnRfYnVsbGV0VGltZSA9IDA7IFxuIFxuICAgIHZhciBnYW1lID0gd2luZG93LmdhbWU7XG4gICAgdmFyIGN1cnNvcnMgPSB3aW5kb3cuY3Vyc29yczsgXG5cbiAgICAgICAgZnVuY3Rpb24gZmlyZUJ1bGxldCAoKSB7IFxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gcmlnaHRfYnVsbGV0VGltZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgcmlnaHRfYnVsbGV0ID0gYnVsbGV0cy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJpZ2h0X2J1bGxldClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQucmVzZXQocGxheWVyLngsIHBsYXllci55ICsgMTYpO1xuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQuYm9keS52ZWxvY2l0eS55ID0gLTMwMDtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0VGltZSA9IGdhbWUudGltZS5ub3cgKyAyMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gbGVmdF9idWxsZXRUaW1lKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBsZWZ0X2J1bGxldCA9IGJ1bGxldHMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChsZWZ0X2J1bGxldClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5yZXNldChwbGF5ZXIueCArIDI2LCBwbGF5ZXIueSArIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgbGVmdF9idWxsZXQuYm9keS52ZWxvY2l0eS55ID0gLTMwMDtcbiAgICAgICAgICAgICAgICAgICAgbGVmdF9idWxsZXRUaW1lID0gZ2FtZS50aW1lLm5vdyArIDIwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAgRm9yIGV4YW1wbGUgdGhpcyBjaGVja3MgaWYgdGhlIHVwIG9yIGRvd24ga2V5cyBhcmUgcHJlc3NlZCBhbmQgbW92ZXMgdGhlIGNhbWVyYSBhY2NvcmRpbmdseS5cbiAgICAgICAgaWYgKGN1cnNvcnMudXAuaXNEb3duKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyAgSWYgdGhlIHNoaWZ0IGtleSBpcyBhbHNvIHByZXNzZWQgdGhlbiB0aGUgd29ybGQgaXMgcm90YXRlZFxuICAgICAgICAgICAgaWYgKGN1cnNvcnMudXAuc2hpZnRLZXkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLy9nYW1lLndvcmxkLnJvdGF0aW9uICs9IDAuMDU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYocGxheWVyLnkgPiAzNTApIHBsYXllci55IC09IDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY3Vyc29ycy5kb3duLmlzRG93bilcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKGN1cnNvcnMuZG93bi5zaGlmdEtleSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gLT0gMC4wNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIueSArPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJzb3JzLmxlZnQuaXNEb3duKVxuICAgICAgICB7XG4gICAgICAgICAgICBwbGF5ZXIueCAtPSA0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGN1cnNvcnMucmlnaHQuaXNEb3duKVxuICAgICAgICB7XG4gICAgICAgICAgIHBsYXllci54ICs9IDQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaW5wdXQua2V5Ym9hcmQuaXNEb3duKFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUikpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZpcmVCdWxsZXQoKSA7XG4gICAgICAgIH1cbiAgICAgICAgLy9jb25zb2xlLmxvZyhjdXJzb3JzKTtcbiAgICAgICAgIGdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcChidWxsZXRzLCBlZiwgY29sbGlzaW9uSGFuZGxlciwgbnVsbCwgdGhpcyk7XG59Il19
