(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
var globals = {
  bullets: null,
  enemies: null,
  player: null
};
var update = require('./game/update');
var preload = require('./game/preload');
var create = require('./game/create');
var game = window.game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
  preload: preload,
  create: create,
  update: update
});


},{"./game/create":2,"./game/preload":4,"./game/update":6}],2:[function(require,module,exports){
"use strict";
function resetBullet(bullet) {
  bullet.kill();
}
;
function setupEnemy(enemy) {
  enemy.anchor.x = 0.5;
  enemy.anchor.y = 0.5;
  enemy.animations.add('explode');
}
;
module.exports = function() {
  game.physics.startSystem(Phaser.Physics.ARCADE);
  this.spaceBG = this.add.tileSprite(0, 0, 800, 600, 'bg');
  this.spaceBG.autoScroll(0, 75);
  window.player = require('./player')(game);
  player.init();
  var bullets = window.bullets = this.add.group();
  bullets.enableBody = true;
  bullets.physicsBodyType = Phaser.Physics.ARCADE;
  bullets.createMultiple(10, 'bullets', 'bullet-green.png');
  bullets.setAll('anchor.x', 0.5);
  bullets.setAll('anchor.y', 1);
  bullets.setAll('outOfBoundsKill', true);
  bullets.setAll('checkWorldBounds', true);
  window.explosions = game.add.group();
  explosions.createMultiple(30, 'explode');
  explosions.forEach(setupEnemy, this);
  window.music = game.add.audio('stage-1');
  window.boom = game.add.audio('boom');
  window.lazer = game.add.audio('lazer');
  window.stage1 = require('./scenes/scene-1')(game);
  stage1.init();
};


},{"./player":3,"./scenes/scene-1":5}],3:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var player,
      cursors;
  var right_bulletTime = 0,
      left_bulletTime = 0;
  function fireBullet() {
    if (game.time.now > right_bulletTime) {
      var right_bullet = bullets.getFirstExists(false);
      if (right_bullet) {
        right_bullet.reset(player.x, player.y + 16);
        right_bullet.body.velocity.y = -300;
        right_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
    if (game.time.now > left_bulletTime + 20) {
      var left_bullet = bullets.getFirstExists(false);
      if (left_bullet) {
        left_bullet.reset(player.x + 26, player.y + 16);
        left_bullet.body.velocity.y = -300;
        left_bulletTime = game.time.now + 1000;
        lazer.play();
      }
    }
  }
  return {
    init: function() {
      player = game.add.sprite((400 - 16), 500, 'ship');
      game.physics.enable(player, Phaser.Physics.ARCADE);
      cursors = game.input.keyboard.createCursorKeys();
    },
    update: function() {
      if (cursors.up.isDown) {
        if (cursors.up.shiftKey) {} else {
          if (player.y > 350)
            player.y -= 4;
        }
      } else if (cursors.down.isDown) {
        if (cursors.down.shiftKey) {} else {
          player.y += 4;
        }
      }
      if (cursors.left.isDown) {
        player.x -= 4;
      } else if (cursors.right.isDown) {
        player.x += 4;
      }
      if (game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {
        fireBullet();
      }
    }
  };
};


},{}],4:[function(require,module,exports){
"use strict";
module.exports = function() {
  this.load.atlas('bullets', 'img/assets/bullets.png', 'img/assets/bullets.json');
  this.load.image('blue_bullet', 'img/assets/blue-bullet.png');
  this.load.image('bg', 'img/backgrounds/bg.png');
  this.load.atlas('atlas', 'img/enemy-fighters/enemy-fighters.png', 'img/enemy-fighters/enemy-fighters.json');
  this.load.image('ship', 'img/space_ship_base.png');
  this.load.spritesheet('explode', 'img/assets/explode.png', 128, 128);
  this.load.audio('boom', ['audio/effects/explode.wav']);
  this.load.audio('lazer', ['audio/effects/lazer.wav']);
  this.load.audio('stage-1', ['audio/background/stage-1.mp3', 'audio/background/stage-1.ogg']);
};


},{}],5:[function(require,module,exports){
"use strict";
module.exports = function(game) {
  var raptors;
  var spawn = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = aliens.create(x, y, 'atlas', 'bad-guy1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 100);
  };
  var collisionHandler = function(bullet, alien) {
    bullet.kill();
    alien.kill();
    window.boom.play();
    var x = alien.body.x,
        y = alien.body.y;
    var explosion = explosions.getFirstExists(false);
    explosion.reset(alien.body.x, alien.body.y);
    explosion.play('explode', 30, false, true);
  };
  var spawnRaptor = function() {
    var x = game.rnd.integerInRange(40, 600),
        y = game.rnd.integerInRange(0, 10);
    var _alien = raptors.create(x, y, 'atlas', 'raptor-1.png');
    _alien.anchor.setTo(0.5, 0.5);
    _alien.body.moves = true;
    _alien.body.velocity.setTo(0, 150);
  };
  var enemyFactory;
  return {
    init: function() {
      window.aliens = game.add.group();
      aliens.enableBody = true;
      aliens.physicsBodyType = Phaser.Physics.ARCADE;
      raptors = game.add.group();
      raptors.enableBody = true;
      raptors.physicsBodyType = Phaser.Physics.ARCADE;
      music.play('', 0, 1, true);
      game.time.events.repeat(Phaser.Timer.SECOND * 2, 105, spawn, this);
      game.time.events.repeat(Phaser.Timer.SECOND * 8, 20, spawnRaptor, this);
    },
    update: function() {
      game.physics.arcade.overlap(bullets, aliens, collisionHandler, null, this);
      game.physics.arcade.overlap(bullets, raptors, collisionHandler, null, this);
    },
    destroy: function() {}
  };
};


},{}],6:[function(require,module,exports){
"use strict";
var bulletTime = 0;
function resetBullet(bullet) {
  bullet.kill();
}
;
var right_bulletTime = 0,
    left_bulletTime = 0;
module.exports = function() {
  var bullets = window.bullets;
  var cursors = window.cursors;
  player.update();
  stage1.update();
};


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2Uvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS9jcmVhdGUuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvcGxheWVyLmpzIiwiL1VzZXJzL2tldmluaXNvbS9Qcm9qZWN0cy9zcGFjZS1kZWZlbnNlL3B1YmxpYy9qcy9nYW1lL3ByZWxvYWQuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvc2NlbmVzL3NjZW5lLTEuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvdXBkYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFBSSxDQUFKLEVBQUksQ0FBQSxPQUFPLEVBQUc7QUFDVixDQUFBLFFBQU8sQ0FBRSxLQUFJO0FBQ2IsQ0FBQSxRQUFPLENBQUUsS0FBSTtBQUNiLENBQUEsT0FBTSxDQUFFLEtBQUk7Q0FBQSxBQUNmLENBQUE7QUFDRyxDQUFKLEVBQUksQ0FBQSxNQUFNLEVBQUcsQ0FBQSxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDbEMsQ0FBSixFQUFJLENBQUEsT0FBTyxFQUFHLENBQUEsT0FBTyxDQUFDLGdCQUFnQixDQUFDLENBQUU7QUFDckMsQ0FBSixFQUFJLENBQUEsTUFBTSxFQUFHLENBQUEsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBRWxDLENB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QUMsQ0FBRSxHQUFFLENBQUUsWUFBVyxDQUFFLEtBQUksQ0FBQyxDQUFDO0tBQzNFO0FBQ0QsQ0FBQSxTQUFNLENBQUcsVUFBVSxDQUFFO0FBRXBCLENBQUEsU0FBSSxRQUFRLE9BQU8sUUFBUSxDQUFDLE9BQU8sQ0FBRSxPQUFNLENBQUUsaUJBQWdCLENBQUUsS0FBSSxDQUFFLEtBQUksQ0FBQyxDQUFDO0FBQzNFLENBQUEsU0FBSSxRQUFRLE9BQU8sUUFBUSxDQUFDLE9BQU8sQ0FBRSxRQUFPLENBQUUsaUJBQWdCLENBQUUsS0FBSSxDQUFFLEtBQUksQ0FBQyxDQUFDO0tBQzVFO0FBQ0QsQ0FBQSxVQUFPLENBQUUsVUFBVSxDQUFFLEdBRXBCO0NBQUEsRUFDRCxDQUFBO0NBQ0QsQ0FBQTtDQUFBOzs7QUN4REQ7QUFBSSxDQUFKLEVBQUksQ0FBQSxVQUFVLEVBQUcsRUFBQyxDQUFDO0NBQ2xCLE9BQVMsWUFBVyxDQUFFLE1BQU0sQ0FBRTtBQUUzQixDQUFBLE9BQU0sS0FBSyxFQUFFLENBQUM7Q0FFakI7QUFBQSxDQUFBLEFBQUM7QUFHTSxDQUFKLEVBQUksQ0FBQSxnQkFBZ0IsRUFBRyxFQUFDO0FBQUUsQ0FBQSxrQkFBZSxFQUFHLEVBQUMsQ0FBQztBQUVsRCxDQUFBLEtBQU0sUUFBUSxFQUFJLFVBQVUsQ0FBRTtBQUN0QixDQUFKLElBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxNQUFNLFFBQVEsQ0FBQztBQUd6QixDQUFKLElBQUksQ0FBQSxPQUFPLEVBQUcsQ0FBQSxNQUFNLFFBQVEsQ0FBQztBQUk3QixDQUFBLE9BQU0sT0FBTyxFQUFFLENBQUM7QUFFWixDQUFBLE9BQU0sT0FBTyxFQUFFLENBQUM7Q0FFdkIsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgZ2xvYmFscyA9IHtcbiAgICBidWxsZXRzOiBudWxsLFxuICAgIGVuZW1pZXM6IG51bGwsXG4gICAgcGxheWVyOiBudWxsXG59XG52YXIgdXBkYXRlID0gcmVxdWlyZSgnLi9nYW1lL3VwZGF0ZScpO1xudmFyIHByZWxvYWQgPSByZXF1aXJlKCcuL2dhbWUvcHJlbG9hZCcpIDtcbnZhciBjcmVhdGUgPSByZXF1aXJlKCcuL2dhbWUvY3JlYXRlJyk7XG4gXG52YXIgZ2FtZSA9IHdpbmRvdy5nYW1lID0gbmV3IFBoYXNlci5HYW1lKDgwMCwgNjAwLCBQaGFzZXIuQVVUTywgJycsIHsgcHJlbG9hZDogcHJlbG9hZCwgY3JlYXRlOiBjcmVhdGUsIHVwZGF0ZTogdXBkYXRlIH0pO1xuIiwiIGZ1bmN0aW9uIHJlc2V0QnVsbGV0IChidWxsZXQpIHtcblxuICAgIGJ1bGxldC5raWxsKCk7XG5cbn1cbjtcbmZ1bmN0aW9uIHNldHVwRW5lbXkgKGVuZW15KSB7XG5cbiAgICBlbmVteS5hbmNob3IueCA9IDAuNTtcbiAgICBlbmVteS5hbmNob3IueSA9IDAuNTtcbiAgICBlbmVteS5hbmltYXRpb25zLmFkZCgnZXhwbG9kZScpO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9ICAgIGZ1bmN0aW9uKCl7XG5cbiAgICBnYW1lLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcblxuICAgIHRoaXMuc3BhY2VCRyA9ICB0aGlzLmFkZC50aWxlU3ByaXRlKDAsIDAsIDgwMCwgNjAwLCAnYmcnKTsgIFxuICAgIHRoaXMuc3BhY2VCRy5hdXRvU2Nyb2xsKDAsIDc1KTsgXG5cblxuICAgIHdpbmRvdy5wbGF5ZXIgPSByZXF1aXJlKCcuL3BsYXllcicpKGdhbWUpO1xuICAgIHBsYXllci5pbml0KCk7XG4gICAgdmFyIGJ1bGxldHMgPSB3aW5kb3cuYnVsbGV0cyA9IHRoaXMuYWRkLmdyb3VwKCk7XG5cbiAgICBidWxsZXRzLmVuYWJsZUJvZHkgPSB0cnVlO1xuXG4gICAgYnVsbGV0cy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XG5cbiAgICBidWxsZXRzLmNyZWF0ZU11bHRpcGxlKDEwLCAnYnVsbGV0cycsICdidWxsZXQtZ3JlZW4ucG5nJyk7XG4gICAgYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci54JywgMC41KTtcbiAgICBidWxsZXRzLnNldEFsbCgnYW5jaG9yLnknLCAxKTtcbiAgICBidWxsZXRzLnNldEFsbCgnb3V0T2ZCb3VuZHNLaWxsJywgdHJ1ZSk7XG4gICAgYnVsbGV0cy5zZXRBbGwoJ2NoZWNrV29ybGRCb3VuZHMnLCB0cnVlKTtcblxuICAgIFxuXG5cbiAgICB3aW5kb3cuZXhwbG9zaW9ucyA9IGdhbWUuYWRkLmdyb3VwKCk7XG4gICAgZXhwbG9zaW9ucy5jcmVhdGVNdWx0aXBsZSgzMCwgJ2V4cGxvZGUnKTtcbiAgICBleHBsb3Npb25zLmZvckVhY2goc2V0dXBFbmVteSwgdGhpcyk7XG4gICAgd2luZG93Lm11c2ljID0gZ2FtZS5hZGQuYXVkaW8oJ3N0YWdlLTEnKTtcbiAgICB3aW5kb3cuYm9vbSA9IGdhbWUuYWRkLmF1ZGlvKCdib29tJyk7XG4gICAgd2luZG93LmxhemVyID0gZ2FtZS5hZGQuYXVkaW8oJ2xhemVyJyk7XG5cbiAgICBcbiAgICB3aW5kb3cuc3RhZ2UxID0gcmVxdWlyZSgnLi9zY2VuZXMvc2NlbmUtMScpKGdhbWUpO1xuICAgIHN0YWdlMS5pbml0KCk7XG59XG5cbiAiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChnYW1lKSB7XG5cdHZhciBwbGF5ZXIsIGN1cnNvcnM7XG5cdHZhciByaWdodF9idWxsZXRUaW1lID0gMCwgbGVmdF9idWxsZXRUaW1lID0gMDsgXG4gICAgICAgIGZ1bmN0aW9uIGZpcmVCdWxsZXQgKCkgeyBcbiAgICAgICAgICAgIGlmICggZ2FtZS50aW1lLm5vdyA+IHJpZ2h0X2J1bGxldFRpbWUpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHJpZ2h0X2J1bGxldCA9IGJ1bGxldHMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChyaWdodF9idWxsZXQpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAvLyAgQW5kIGZpcmUgaXRcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0LnJlc2V0KHBsYXllci54LCBwbGF5ZXIueSArIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0LmJvZHkudmVsb2NpdHkueSA9IC0zMDA7XG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0X2J1bGxldFRpbWUgPSBnYW1lLnRpbWUubm93ICsgMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgbGF6ZXIucGxheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggZ2FtZS50aW1lLm5vdyA+IGxlZnRfYnVsbGV0VGltZSArIDIwKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBsZWZ0X2J1bGxldCA9IGJ1bGxldHMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChsZWZ0X2J1bGxldClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5yZXNldChwbGF5ZXIueCArIDI2LCBwbGF5ZXIueSArIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgbGVmdF9idWxsZXQuYm9keS52ZWxvY2l0eS55ID0gLTMwMDtcbiAgICAgICAgICAgICAgICAgICAgbGVmdF9idWxsZXRUaW1lID0gZ2FtZS50aW1lLm5vdyArIDEwMDA7XG4gICAgICAgICAgICAgICAgICAgIGxhemVyLnBsYXkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXHRyZXR1cm4ge1xuXHRcdGluaXQgOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRwbGF5ZXIgPSBnYW1lLmFkZC5zcHJpdGUoKDQwMCAtIDE2KSwgNTAwLCAnc2hpcCcpO1xuICAgIFx0XHRnYW1lLnBoeXNpY3MuZW5hYmxlKHBsYXllciwgUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcbiAgICBcdFx0Y3Vyc29ycyA9ICBnYW1lLmlucHV0LmtleWJvYXJkLmNyZWF0ZUN1cnNvcktleXMoKTtcblx0XHR9LFxuXHRcdHVwZGF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyAgRm9yIGV4YW1wbGUgdGhpcyBjaGVja3MgaWYgdGhlIHVwIG9yIGRvd24ga2V5cyBhcmUgcHJlc3NlZCBhbmQgbW92ZXMgdGhlIGNhbWVyYSBhY2NvcmRpbmdseS5cblx0ICAgICAgICBpZiAoY3Vyc29ycy51cC5pc0Rvd24pXG5cdCAgICAgICAge1xuXHQgICAgICAgICAgICAvLyAgSWYgdGhlIHNoaWZ0IGtleSBpcyBhbHNvIHByZXNzZWQgdGhlbiB0aGUgd29ybGQgaXMgcm90YXRlZFxuXHQgICAgICAgICAgICBpZiAoY3Vyc29ycy51cC5zaGlmdEtleSlcblx0ICAgICAgICAgICAge1xuXHQgICAgICAgICAgICAgICAgLy9nYW1lLndvcmxkLnJvdGF0aW9uICs9IDAuMDU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZWxzZVxuXHQgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICBpZihwbGF5ZXIueSA+IDM1MCkgcGxheWVyLnkgLT0gNDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIGlmIChjdXJzb3JzLmRvd24uaXNEb3duKVxuXHQgICAgICAgIHtcblx0ICAgICAgICAgICAgaWYgKGN1cnNvcnMuZG93bi5zaGlmdEtleSlcblx0ICAgICAgICAgICAge1xuXHQgICAgICAgICAgICAgICAgLy9nYW1lLndvcmxkLnJvdGF0aW9uIC09IDAuMDU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgZWxzZVxuXHQgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICBwbGF5ZXIueSArPSA0O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChjdXJzb3JzLmxlZnQuaXNEb3duKVxuXHQgICAgICAgIHtcblx0ICAgICAgICAgICAgcGxheWVyLnggLT0gNDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSBpZiAoY3Vyc29ycy5yaWdodC5pc0Rvd24pXG5cdCAgICAgICAge1xuXHQgICAgICAgICAgIHBsYXllci54ICs9IDQ7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChnYW1lLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuU1BBQ0VCQVIpKVxuXHQgICAgICAgIHtcblx0ICAgICAgICAgICAgZmlyZUJ1bGxldCgpIDtcblx0ICAgICAgICB9XG5cdFx0fVxuXHR9XG59IiwibW9kdWxlLmV4cG9ydHMgPSAgZnVuY3Rpb24gKCkge1xuIFxuICAgIHRoaXMubG9hZC5hdGxhcygnYnVsbGV0cycsICdpbWcvYXNzZXRzL2J1bGxldHMucG5nJywgJ2ltZy9hc3NldHMvYnVsbGV0cy5qc29uJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdibHVlX2J1bGxldCcsICdpbWcvYXNzZXRzL2JsdWUtYnVsbGV0LnBuZycpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnYmcnLCAnaW1nL2JhY2tncm91bmRzL2JnLnBuZycpOyBcbiAgICB0aGlzLmxvYWQuYXRsYXMoJ2F0bGFzJywgJ2ltZy9lbmVteS1maWdodGVycy9lbmVteS1maWdodGVycy5wbmcnLCAnaW1nL2VuZW15LWZpZ2h0ZXJzL2VuZW15LWZpZ2h0ZXJzLmpzb24nKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3NoaXAnLCAnaW1nL3NwYWNlX3NoaXBfYmFzZS5wbmcnKTtcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2V4cGxvZGUnLCAnaW1nL2Fzc2V0cy9leHBsb2RlLnBuZycsIDEyOCwgMTI4KTtcbiAgICB0aGlzLmxvYWQuYXVkaW8oJ2Jvb20nLCBbJ2F1ZGlvL2VmZmVjdHMvZXhwbG9kZS53YXYnXSk7XG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdsYXplcicsIFsnYXVkaW8vZWZmZWN0cy9sYXplci53YXYnXSk7XG4gICAgdGhpcy5sb2FkLmF1ZGlvKCdzdGFnZS0xJywgWydhdWRpby9iYWNrZ3JvdW5kL3N0YWdlLTEubXAzJywgJ2F1ZGlvL2JhY2tncm91bmQvc3RhZ2UtMS5vZ2cnXSk7XG5cbn0iLCJtb2R1bGUuZXhwb3J0cyA9ICBmdW5jdGlvbiAoZ2FtZSkge1xuXHR2YXIgcmFwdG9ycztcbiAgICB2YXIgc3Bhd24gPSBmdW5jdGlvbiAoKSB7IFxuXG4gICAgICAgIHZhciB4ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoNDAsIDYwMCkgICwgeSA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEwKTtcbiAgICAgICAgdmFyIF9hbGllbiA9IGFsaWVucy5jcmVhdGUoeCwgeSwgJ2F0bGFzJywgJ2JhZC1ndXkxLnBuZycpO1xuICAgICAgICBfYWxpZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcbiBcbiAgICAgICAgX2FsaWVuLmJvZHkubW92ZXMgPSB0cnVlO1xuICAgICAgICBfYWxpZW4uYm9keS52ZWxvY2l0eS5zZXRUbygwLCAxMDApIDsgXG4gICAgfTtcblxuXHR2YXIgY29sbGlzaW9uSGFuZGxlciA9IGZ1bmN0aW9uICAoYnVsbGV0LCBhbGllbikge1xuXG5cdCAgICBidWxsZXQua2lsbCgpO1xuXHQgICAgYWxpZW4ua2lsbCgpO1xuXHQgICAgd2luZG93LmJvb20ucGxheSgpO1xuXHQgICAgdmFyIHggPSBhbGllbi5ib2R5LngsIHkgPWFsaWVuLmJvZHkueVxuXHQgICAgdmFyIGV4cGxvc2lvbiA9IGV4cGxvc2lvbnMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xuXHQgICAgZXhwbG9zaW9uLnJlc2V0KGFsaWVuLmJvZHkueCwgYWxpZW4uYm9keS55KTtcblx0ICAgIGV4cGxvc2lvbi5wbGF5KCdleHBsb2RlJywgMzAsIGZhbHNlLCB0cnVlKTtcblx0fTtcblxuICAgIHZhciBzcGF3blJhcHRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICBcdHZhciB4ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoNDAsIDYwMCkgICwgeSA9IGdhbWUucm5kLmludGVnZXJJblJhbmdlKDAsIDEwKTtcbiAgICAgICAgdmFyIF9hbGllbiA9IHJhcHRvcnMuY3JlYXRlKHgsIHksICdhdGxhcycsICdyYXB0b3ItMS5wbmcnKTtcbiAgICAgICAgX2FsaWVuLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gXG4gICAgICAgIF9hbGllbi5ib2R5Lm1vdmVzID0gdHJ1ZTtcbiAgICAgICAgX2FsaWVuLmJvZHkudmVsb2NpdHkuc2V0VG8oMCwgMTUwKSA7IFxuICAgIH1cblx0dmFyIGVuZW15RmFjdG9yeTtcblxuXHRyZXR1cm4ge1xuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHdpbmRvdy5hbGllbnMgPSBnYW1lLmFkZC5ncm91cCgpO1xuICAgIFx0XHRhbGllbnMuZW5hYmxlQm9keSA9IHRydWU7XG4gICAgXHRcdGFsaWVucy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XG4gICAgXHRcdHJhcHRvcnMgPSBnYW1lLmFkZC5ncm91cCgpO1xuICAgIFx0XHRyYXB0b3JzLmVuYWJsZUJvZHkgPSB0cnVlO1xuICAgIFx0XHRyYXB0b3JzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcblx0XHQgICAgbXVzaWMucGxheSgnJywgMCwgMSwgdHJ1ZSk7XG5cbiAgICBcdFx0Z2FtZS50aW1lLmV2ZW50cy5yZXBlYXQoUGhhc2VyLlRpbWVyLlNFQ09ORCAqIDIsIDEwNSwgc3Bhd24sIHRoaXMpO1xuXG4gICAgXHRcdGdhbWUudGltZS5ldmVudHMucmVwZWF0KFBoYXNlci5UaW1lci5TRUNPTkQgKiA4LCAyMCwgc3Bhd25SYXB0b3IsIHRoaXMpO1xuXHRcdH0sXG5cdFx0dXBkYXRlIDogZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9nYW1lIGxvb3AgZm9yIHRoZSBzdGFnZVxuXHRcdFx0Z2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKGJ1bGxldHMsIGFsaWVucywgY29sbGlzaW9uSGFuZGxlciwgbnVsbCwgdGhpcyk7XG5cdFx0XHRnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAoYnVsbGV0cywgcmFwdG9ycywgY29sbGlzaW9uSGFuZGxlciwgbnVsbCwgdGhpcyk7XG5cdFx0fSxcblx0XHRkZXN0cm95OiBmdW5jdGlvbiAoKSB7XG5cblx0XHR9XG5cdH1cbn0iLCJ2YXIgYnVsbGV0VGltZSA9IDA7XG4gZnVuY3Rpb24gcmVzZXRCdWxsZXQgKGJ1bGxldCkge1xuXG4gICAgYnVsbGV0LmtpbGwoKTtcblxufTtcblxuIFxuICAgIHZhciByaWdodF9idWxsZXRUaW1lID0gMCwgbGVmdF9idWxsZXRUaW1lID0gMDsgXG5cbm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYnVsbGV0cyA9IHdpbmRvdy5idWxsZXRzO1xuXG4gICAgXG4gICAgdmFyIGN1cnNvcnMgPSB3aW5kb3cuY3Vyc29yczsgXG5cblxuXG4gICAgcGxheWVyLnVwZGF0ZSgpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKGN1cnNvcnMpO1xuICAgICAgICBzdGFnZTEudXBkYXRlKCk7XG4gICAgICAgIFxufTtcbiJdfQ==
