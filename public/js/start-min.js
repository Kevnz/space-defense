(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var globals={bullets:null,enemies:null,player:null},update=require("./game/update"),preload=require("./game/preload"),create=require("./game/create"),game=window.game=new Phaser.Game(800,600,Phaser.AUTO,"",{preload:preload,create:create,update:update});
//# sourceMappingURL=out.js.map

},{"./game/create":2,"./game/preload":4,"./game/update":6}],2:[function(require,module,exports){
"use strict";function resetBullet(e){e.kill()}function setupEnemy(e){e.anchor.x=.5,e.anchor.y=.5,e.animations.add("explode")}module.exports=function(){game.physics.startSystem(Phaser.Physics.ARCADE),this.spaceBG=this.add.tileSprite(0,0,800,600,"bg"),this.spaceBG.autoScroll(0,75),window.player=require("./player")(game),player.init();var e=window.bullets=this.add.group();e.enableBody=!0,e.physicsBodyType=Phaser.Physics.ARCADE,e.createMultiple(10,"bullets","bullet-green.png"),e.setAll("anchor.x",.5),e.setAll("anchor.y",1),e.setAll("outOfBoundsKill",!0),e.setAll("checkWorldBounds",!0),window.explosions=game.add.group(),explosions.createMultiple(30,"explode"),explosions.forEach(setupEnemy,this),window.music=game.add.audio("stage-1"),window.boom=game.add.audio("boom"),window.lazer=game.add.audio("lazer"),window.stage1=require("./scenes/scene-1")(game),stage1.init()};
//# sourceMappingURL=out.js.map

},{"./player":3,"./scenes/scene-1":5}],3:[function(require,module,exports){
"use strict";module.exports=function(e){function t(){if(e.time.now>o){var t=bullets.getFirstExists(!1);t&&(t.reset(i.x,i.y+16),t.body.velocity.y=-300,o=e.time.now+1e3,lazer.play())}if(e.time.now>n+20){var s=bullets.getFirstExists(!1);s&&(s.reset(i.x+26,i.y+16),s.body.velocity.y=-300,n=e.time.now+1e3,lazer.play())}}var i,s,o=0,n=0;return{init:function(){i=e.add.sprite(384,500,"ship"),e.physics.enable(i,Phaser.Physics.ARCADE),s=e.input.keyboard.createCursorKeys()},update:function(){s.up.isDown?s.up.shiftKey||i.y>350&&(i.y-=4):s.down.isDown&&(s.down.shiftKey||(i.y+=4)),s.left.isDown?i.x-=4:s.right.isDown&&(i.x+=4),e.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&t()}}};
//# sourceMappingURL=out.js.map

},{}],4:[function(require,module,exports){
"use strict";module.exports=function(){this.load.atlas("bullets","img/assets/bullets.png","img/assets/bullets.json"),this.load.image("blue_bullet","img/assets/blue-bullet.png"),this.load.image("bg","img/backgrounds/bg.png"),this.load.atlas("atlas","img/enemy-fighters/enemy-fighters.png","img/enemy-fighters/enemy-fighters.json"),this.load.image("ship","img/space_ship_base.png"),this.load.spritesheet("explode","img/assets/explode.png",128,128),this.load.audio("boom",["audio/effects/explode.wav"]),this.load.audio("lazer",["audio/effects/lazer.wav"]),this.load.audio("stage-1",["audio/background/stage-1.mp3","audio/background/stage-1.ogg"])};
//# sourceMappingURL=out.js.map

},{}],5:[function(require,module,exports){
"use strict";module.exports=function(e){var n,s=function(){var n=e.rnd.integerInRange(40,600),s=e.rnd.integerInRange(0,10),t=aliens.create(n,s,"atlas","bad-guy1.png");t.anchor.setTo(.5,.5),t.body.moves=!0,t.body.velocity.setTo(0,100)},t=function(e,n){e.kill(),n.kill(),window.boom.play();var s=(n.body.x,n.body.y,explosions.getFirstExists(!1));s.reset(n.body.x,n.body.y),s.play("explode",30,!1,!0)},o=function(){var s=e.rnd.integerInRange(40,600),t=e.rnd.integerInRange(0,10),o=n.create(s,t,"atlas","raptor-1.png");o.anchor.setTo(.5,.5),o.body.moves=!0,o.body.velocity.setTo(0,150)};return{init:function(){window.aliens=e.add.group(),aliens.enableBody=!0,aliens.physicsBodyType=Phaser.Physics.ARCADE,n=e.add.group(),n.enableBody=!0,n.physicsBodyType=Phaser.Physics.ARCADE,music.play("",0,1,!0),e.time.events.repeat(2*Phaser.Timer.SECOND,105,s,this),e.time.events.repeat(8*Phaser.Timer.SECOND,20,o,this)},update:function(){e.physics.arcade.overlap(bullets,aliens,t,null,this),e.physics.arcade.overlap(bullets,n,t,null,this)},destroy:function(){}}};
//# sourceMappingURL=out.js.map

},{}],6:[function(require,module,exports){
"use strict";function resetBullet(e){e.kill()}var bulletTime=0,right_bulletTime=0,left_bulletTime=0;module.exports=function(){window.bullets,window.cursors;player.update(),stage1.update()};
//# sourceMappingURL=out.js.map

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2Uvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS5qcyIsIi9Vc2Vycy9rZXZpbmlzb20vUHJvamVjdHMvc3BhY2UtZGVmZW5zZS9wdWJsaWMvanMvZ2FtZS9jcmVhdGUuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvcGxheWVyLmpzIiwiL1VzZXJzL2tldmluaXNvbS9Qcm9qZWN0cy9zcGFjZS1kZWZlbnNlL3B1YmxpYy9qcy9nYW1lL3ByZWxvYWQuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvc2NlbmVzL3NjZW5lLTEuanMiLCIvVXNlcnMva2V2aW5pc29tL1Byb2plY3RzL3NwYWNlLWRlZmVuc2UvcHVibGljL2pzL2dhbWUvdXBkYXRlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsWUFBSSxJQUFBLFVBQ0EsUUFBUyxLQUNULFFBQVMsS0FDVCxPQUFRLE1BRVIsT0FBUyxRQUFRLGlCQUNqQixRQUFVLFFBQVEsa0JBQ2xCLE9BQVMsUUFBUSxpQkFFakIsS0FBTyxPQUFNLEtBQVEsR0FBSSxRQUFNLEtBQU0sSUFBSyxJQUFLLE9BQU0sS0FBTyxJQUFNLFFBQVMsUUFBUyxPQUFRLE9BQVEsT0FBUTs7OztBQ1QvRyxxQkFBUyxhQUFhLEdBRW5CLEVBQU0sZUFJRCxZQUFZLEdBRWpCLEVBQUssT0FBTyxFQUFLLEdBQ2pCLEVBQUssT0FBTyxFQUFLLEdBQ2pCLEVBQUssV0FBVyxJQUFLLFdBSXpCLE9BQU0sUUFBYyxXQUVoQixLQUFJLFFBQVEs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QU0sT0FJcEIsUUFBTSxTQUVGLE9BQU0iLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBnbG9iYWxzID0ge1xuICAgIGJ1bGxldHM6IG51bGwsXG4gICAgZW5lbWllczogbnVsbCxcbiAgICBwbGF5ZXI6IG51bGxcbn1cbnZhciB1cGRhdGUgPSByZXF1aXJlKCcuL2dhbWUvdXBkYXRlJyk7XG52YXIgcHJlbG9hZCA9IHJlcXVpcmUoJy4vZ2FtZS9wcmVsb2FkJykgO1xudmFyIGNyZWF0ZSA9IHJlcXVpcmUoJy4vZ2FtZS9jcmVhdGUnKTtcbiBcbnZhciBnYW1lID0gd2luZG93LmdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoODAwLCA2MDAsIFBoYXNlci5BVVRPLCAnJywgeyBwcmVsb2FkOiBwcmVsb2FkLCBjcmVhdGU6IGNyZWF0ZSwgdXBkYXRlOiB1cGRhdGUgfSk7XG4iLCIgZnVuY3Rpb24gcmVzZXRCdWxsZXQgKGJ1bGxldCkge1xuXG4gICAgYnVsbGV0LmtpbGwoKTtcblxufVxuO1xuZnVuY3Rpb24gc2V0dXBFbmVteSAoZW5lbXkpIHtcblxuICAgIGVuZW15LmFuY2hvci54ID0gMC41O1xuICAgIGVuZW15LmFuY2hvci55ID0gMC41O1xuICAgIGVuZW15LmFuaW1hdGlvbnMuYWRkKCdleHBsb2RlJyk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gICAgZnVuY3Rpb24oKXtcblxuICAgIGdhbWUucGh5c2ljcy5zdGFydFN5c3RlbShQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuXG4gICAgdGhpcy5zcGFjZUJHID0gIHRoaXMuYWRkLnRpbGVTcHJpdGUoMCwgMCwgODAwLCA2MDAsICdiZycpOyAgXG4gICAgdGhpcy5zcGFjZUJHLmF1dG9TY3JvbGwoMCwgNzUpOyBcblxuXG4gICAgd2luZG93LnBsYXllciA9IHJlcXVpcmUoJy4vcGxheWVyJykoZ2FtZSk7XG4gICAgcGxheWVyLmluaXQoKTtcbiAgICB2YXIgYnVsbGV0cyA9IHdpbmRvdy5idWxsZXRzID0gdGhpcy5hZGQuZ3JvdXAoKTtcblxuICAgIGJ1bGxldHMuZW5hYmxlQm9keSA9IHRydWU7XG5cbiAgICBidWxsZXRzLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcblxuICAgIGJ1bGxldHMuY3JlYXRlTXVsdGlwbGUoMTAsICdidWxsZXRzJywgJ2J1bGxldC1ncmVlbi5wbmcnKTtcbiAgICBidWxsZXRzLnNldEFsbCgnYW5jaG9yLngnLCAwLjUpO1xuICAgIGJ1bGxldHMuc2V0QWxsKCdhbmNob3IueScsIDEpO1xuICAgIGJ1bGxldHMuc2V0QWxsKCdvdXRPZkJvdW5kc0tpbGwnLCB0cnVlKTtcbiAgICBidWxsZXRzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpO1xuXG4gICAgXG5cblxuICAgIHdpbmRvdy5leHBsb3Npb25zID0gZ2FtZS5hZGQuZ3JvdXAoKTtcbiAgICBleHBsb3Npb25zLmNyZWF0ZU11bHRpcGxlKDMwLCAnZXhwbG9kZScpO1xuICAgIGV4cGxvc2lvbnMuZm9yRWFjaChzZXR1cEVuZW15LCB0aGlzKTtcbiAgICB3aW5kb3cubXVzaWMgPSBnYW1lLmFkZC5hdWRpbygnc3RhZ2UtMScpO1xuICAgIHdpbmRvdy5ib29tID0gZ2FtZS5hZGQuYXVkaW8oJ2Jvb20nKTtcbiAgICB3aW5kb3cubGF6ZXIgPSBnYW1lLmFkZC5hdWRpbygnbGF6ZXInKTtcblxuICAgIFxuICAgIHdpbmRvdy5zdGFnZTEgPSByZXF1aXJlKCcuL3NjZW5lcy9zY2VuZS0xJykoZ2FtZSk7XG4gICAgc3RhZ2UxLmluaXQoKTtcbn1cblxuICIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGdhbWUpIHtcblx0dmFyIHBsYXllciwgY3Vyc29ycztcblx0dmFyIHJpZ2h0X2J1bGxldFRpbWUgPSAwLCBsZWZ0X2J1bGxldFRpbWUgPSAwOyBcbiAgICAgICAgZnVuY3Rpb24gZmlyZUJ1bGxldCAoKSB7IFxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gcmlnaHRfYnVsbGV0VGltZSlcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgcmlnaHRfYnVsbGV0ID0gYnVsbGV0cy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJpZ2h0X2J1bGxldClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIC8vICBBbmQgZmlyZSBpdFxuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQucmVzZXQocGxheWVyLngsIHBsYXllci55ICsgMTYpO1xuICAgICAgICAgICAgICAgICAgICByaWdodF9idWxsZXQuYm9keS52ZWxvY2l0eS55ID0gLTMwMDtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHRfYnVsbGV0VGltZSA9IGdhbWUudGltZS5ub3cgKyAxMDAwO1xuICAgICAgICAgICAgICAgICAgICBsYXplci5wbGF5KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCBnYW1lLnRpbWUubm93ID4gbGVmdF9idWxsZXRUaW1lICsgMjApXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIGxlZnRfYnVsbGV0ID0gYnVsbGV0cy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKGxlZnRfYnVsbGV0KVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gIEFuZCBmaXJlIGl0XG4gICAgICAgICAgICAgICAgICAgIGxlZnRfYnVsbGV0LnJlc2V0KHBsYXllci54ICsgMjYsIHBsYXllci55ICsgMTYpO1xuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldC5ib2R5LnZlbG9jaXR5LnkgPSAtMzAwO1xuICAgICAgICAgICAgICAgICAgICBsZWZ0X2J1bGxldFRpbWUgPSBnYW1lLnRpbWUubm93ICsgMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgbGF6ZXIucGxheSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cdHJldHVybiB7XG5cdFx0aW5pdCA6IGZ1bmN0aW9uICgpIHtcblx0XHRcdHBsYXllciA9IGdhbWUuYWRkLnNwcml0ZSgoNDAwIC0gMTYpLCA1MDAsICdzaGlwJyk7XG4gICAgXHRcdGdhbWUucGh5c2ljcy5lbmFibGUocGxheWVyLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuICAgIFx0XHRjdXJzb3JzID0gIGdhbWUuaW5wdXQua2V5Ym9hcmQuY3JlYXRlQ3Vyc29yS2V5cygpO1xuXHRcdH0sXG5cdFx0dXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vICBGb3IgZXhhbXBsZSB0aGlzIGNoZWNrcyBpZiB0aGUgdXAgb3IgZG93biBrZXlzIGFyZSBwcmVzc2VkIGFuZCBtb3ZlcyB0aGUgY2FtZXJhIGFjY29yZGluZ2x5LlxuXHQgICAgICAgIGlmIChjdXJzb3JzLnVwLmlzRG93bilcblx0ICAgICAgICB7XG5cdCAgICAgICAgICAgIC8vICBJZiB0aGUgc2hpZnQga2V5IGlzIGFsc28gcHJlc3NlZCB0aGVuIHRoZSB3b3JsZCBpcyByb3RhdGVkXG5cdCAgICAgICAgICAgIGlmIChjdXJzb3JzLnVwLnNoaWZ0S2V5KVxuXHQgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gKz0gMC4wNTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlXG5cdCAgICAgICAgICAgIHtcblx0ICAgICAgICAgICAgICAgIGlmKHBsYXllci55ID4gMzUwKSBwbGF5ZXIueSAtPSA0O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2UgaWYgKGN1cnNvcnMuZG93bi5pc0Rvd24pXG5cdCAgICAgICAge1xuXHQgICAgICAgICAgICBpZiAoY3Vyc29ycy5kb3duLnNoaWZ0S2V5KVxuXHQgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICAvL2dhbWUud29ybGQucm90YXRpb24gLT0gMC4wNTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBlbHNlXG5cdCAgICAgICAgICAgIHtcblx0ICAgICAgICAgICAgICAgIHBsYXllci55ICs9IDQ7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGN1cnNvcnMubGVmdC5pc0Rvd24pXG5cdCAgICAgICAge1xuXHQgICAgICAgICAgICBwbGF5ZXIueCAtPSA0O1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIGlmIChjdXJzb3JzLnJpZ2h0LmlzRG93bilcblx0ICAgICAgICB7XG5cdCAgICAgICAgICAgcGxheWVyLnggKz0gNDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKGdhbWUuaW5wdXQua2V5Ym9hcmQuaXNEb3duKFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUikpXG5cdCAgICAgICAge1xuXHQgICAgICAgICAgICBmaXJlQnVsbGV0KCkgO1xuXHQgICAgICAgIH1cblx0XHR9XG5cdH1cbn0iLCJtb2R1bGUuZXhwb3J0cyA9ICBmdW5jdGlvbiAoKSB7XG4gXG4gICAgdGhpcy5sb2FkLmF0bGFzKCdidWxsZXRzJywgJ2ltZy9hc3NldHMvYnVsbGV0cy5wbmcnLCAnaW1nL2Fzc2V0cy9idWxsZXRzLmpzb24nKTtcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2JsdWVfYnVsbGV0JywgJ2ltZy9hc3NldHMvYmx1ZS1idWxsZXQucG5nJyk7XG4gICAgdGhpcy5sb2FkLmltYWdlKCdiZycsICdpbWcvYmFja2dyb3VuZHMvYmcucG5nJyk7IFxuICAgIHRoaXMubG9hZC5hdGxhcygnYXRsYXMnLCAnaW1nL2VuZW15LWZpZ2h0ZXJzL2VuZW15LWZpZ2h0ZXJzLnBuZycsICdpbWcvZW5lbXktZmlnaHRlcnMvZW5lbXktZmlnaHRlcnMuanNvbicpO1xuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hpcCcsICdpbWcvc3BhY2Vfc2hpcF9iYXNlLnBuZycpO1xuICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnZXhwbG9kZScsICdpbWcvYXNzZXRzL2V4cGxvZGUucG5nJywgMTI4LCAxMjgpO1xuICAgIHRoaXMubG9hZC5hdWRpbygnYm9vbScsIFsnYXVkaW8vZWZmZWN0cy9leHBsb2RlLndhdiddKTtcbiAgICB0aGlzLmxvYWQuYXVkaW8oJ2xhemVyJywgWydhdWRpby9lZmZlY3RzL2xhemVyLndhdiddKTtcbiAgICB0aGlzLmxvYWQuYXVkaW8oJ3N0YWdlLTEnLCBbJ2F1ZGlvL2JhY2tncm91bmQvc3RhZ2UtMS5tcDMnLCAnYXVkaW8vYmFja2dyb3VuZC9zdGFnZS0xLm9nZyddKTtcblxufSIsIm1vZHVsZS5leHBvcnRzID0gIGZ1bmN0aW9uIChnYW1lKSB7XG5cdHZhciByYXB0b3JzO1xuICAgIHZhciBzcGF3biA9IGZ1bmN0aW9uICgpIHsgXG5cbiAgICAgICAgdmFyIHggPSBnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSg0MCwgNjAwKSAgLCB5ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgMTApO1xuICAgICAgICB2YXIgX2FsaWVuID0gYWxpZW5zLmNyZWF0ZSh4LCB5LCAnYXRsYXMnLCAnYmFkLWd1eTEucG5nJyk7XG4gICAgICAgIF9hbGllbi5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuIFxuICAgICAgICBfYWxpZW4uYm9keS5tb3ZlcyA9IHRydWU7XG4gICAgICAgIF9hbGllbi5ib2R5LnZlbG9jaXR5LnNldFRvKDAsIDEwMCkgOyBcbiAgICB9O1xuXG5cdHZhciBjb2xsaXNpb25IYW5kbGVyID0gZnVuY3Rpb24gIChidWxsZXQsIGFsaWVuKSB7XG5cblx0ICAgIGJ1bGxldC5raWxsKCk7XG5cdCAgICBhbGllbi5raWxsKCk7XG5cdCAgICB3aW5kb3cuYm9vbS5wbGF5KCk7XG5cdCAgICB2YXIgeCA9IGFsaWVuLmJvZHkueCwgeSA9YWxpZW4uYm9keS55XG5cdCAgICB2YXIgZXhwbG9zaW9uID0gZXhwbG9zaW9ucy5nZXRGaXJzdEV4aXN0cyhmYWxzZSk7XG5cdCAgICBleHBsb3Npb24ucmVzZXQoYWxpZW4uYm9keS54LCBhbGllbi5ib2R5LnkpO1xuXHQgICAgZXhwbG9zaW9uLnBsYXkoJ2V4cGxvZGUnLCAzMCwgZmFsc2UsIHRydWUpO1xuXHR9O1xuXG4gICAgdmFyIHNwYXduUmFwdG9yID0gZnVuY3Rpb24gKCkge1xuICAgIFx0dmFyIHggPSBnYW1lLnJuZC5pbnRlZ2VySW5SYW5nZSg0MCwgNjAwKSAgLCB5ID0gZ2FtZS5ybmQuaW50ZWdlckluUmFuZ2UoMCwgMTApO1xuICAgICAgICB2YXIgX2FsaWVuID0gcmFwdG9ycy5jcmVhdGUoeCwgeSwgJ2F0bGFzJywgJ3JhcHRvci0xLnBuZycpO1xuICAgICAgICBfYWxpZW4uYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcbiBcbiAgICAgICAgX2FsaWVuLmJvZHkubW92ZXMgPSB0cnVlO1xuICAgICAgICBfYWxpZW4uYm9keS52ZWxvY2l0eS5zZXRUbygwLCAxNTApIDsgXG4gICAgfVxuXHR2YXIgZW5lbXlGYWN0b3J5O1xuXG5cdHJldHVybiB7XG5cdFx0aW5pdDogZnVuY3Rpb24gKCkge1xuXHRcdFx0d2luZG93LmFsaWVucyA9IGdhbWUuYWRkLmdyb3VwKCk7XG4gICAgXHRcdGFsaWVucy5lbmFibGVCb2R5ID0gdHJ1ZTtcbiAgICBcdFx0YWxpZW5zLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcbiAgICBcdFx0cmFwdG9ycyA9IGdhbWUuYWRkLmdyb3VwKCk7XG4gICAgXHRcdHJhcHRvcnMuZW5hYmxlQm9keSA9IHRydWU7XG4gICAgXHRcdHJhcHRvcnMucGh5c2ljc0JvZHlUeXBlID0gUGhhc2VyLlBoeXNpY3MuQVJDQURFO1xuXHRcdCAgICBtdXNpYy5wbGF5KCcnLCAwLCAxLCB0cnVlKTtcblxuICAgIFx0XHRnYW1lLnRpbWUuZXZlbnRzLnJlcGVhdChQaGFzZXIuVGltZXIuU0VDT05EICogMiwgMTA1LCBzcGF3biwgdGhpcyk7XG5cbiAgICBcdFx0Z2FtZS50aW1lLmV2ZW50cy5yZXBlYXQoUGhhc2VyLlRpbWVyLlNFQ09ORCAqIDgsIDIwLCBzcGF3blJhcHRvciwgdGhpcyk7XG5cdFx0fSxcblx0XHR1cGRhdGUgOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvL2dhbWUgbG9vcCBmb3IgdGhlIHN0YWdlXG5cdFx0XHRnYW1lLnBoeXNpY3MuYXJjYWRlLm92ZXJsYXAoYnVsbGV0cywgYWxpZW5zLCBjb2xsaXNpb25IYW5kbGVyLCBudWxsLCB0aGlzKTtcblx0XHRcdGdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcChidWxsZXRzLCByYXB0b3JzLCBjb2xsaXNpb25IYW5kbGVyLCBudWxsLCB0aGlzKTtcblx0XHR9LFxuXHRcdGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHtcblxuXHRcdH1cblx0fVxufSIsInZhciBidWxsZXRUaW1lID0gMDtcbiBmdW5jdGlvbiByZXNldEJ1bGxldCAoYnVsbGV0KSB7XG5cbiAgICBidWxsZXQua2lsbCgpO1xuXG59O1xuXG4gXG4gICAgdmFyIHJpZ2h0X2J1bGxldFRpbWUgPSAwLCBsZWZ0X2J1bGxldFRpbWUgPSAwOyBcblxubW9kdWxlLmV4cG9ydHMgPSAgZnVuY3Rpb24gKCkge1xuICAgIHZhciBidWxsZXRzID0gd2luZG93LmJ1bGxldHM7XG5cbiAgICBcbiAgICB2YXIgY3Vyc29ycyA9IHdpbmRvdy5jdXJzb3JzOyBcblxuXG5cbiAgICBwbGF5ZXIudXBkYXRlKCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coY3Vyc29ycyk7XG4gICAgICAgIHN0YWdlMS51cGRhdGUoKTtcbiAgICAgICAgXG59O1xuIl19
